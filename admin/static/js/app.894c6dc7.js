(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)r=o[d],n[r]&&p.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},n={app:0},s=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"170a":function(t,e,a){"use strict";var i=a("5135"),n=a.n(i);n.a},3995:function(t,e,a){},"4aba":function(t,e,a){"use strict";var i=a("ffc8"),n=a.n(i);n.a},5135:function(t,e,a){},"52ab":function(t,e,a){"use strict";var i=a("da00"),n=a.n(i);n.a},5585:function(t,e,a){"use strict";var i=a("8ce4"),n=a.n(i);n.a},"56d7":function(t,e,a){"use strict";a.r(e);a("a481"),a("3b2b"),a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},["/login"!=t.$route.path&&"/"!=t.$route.path?a("top"):t._e(),a("router-view",{staticClass:"router",class:{full:"/login"==t.$route.path||"/"==t.$route.path}}),"/login"!=t.$route.path&&"/"!=t.$route.path?a("side"):t._e()],1)},s=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"top"},[t.info?[a("el-dropdown",{attrs:{trigger:"click"}},[a("span",{staticClass:"el-dropdown-link"},[""!=t.photo?a("span",{staticClass:"photo",style:{"background-image":"url("+this.photo+")"}}):t._e(),""==t.photo?a("span",{staticClass:"photo"},[t._v(t._s(t.nickname.substr(0,1)))]):t._e(),a("span",{staticClass:"name"},[a("tt",[t._v(t._s(t.account))]),a("br"),a("em",[t._v(t._s(t.nickname))])],1),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(e){return t.profile()}}},[t._v("修改密码")]),a("el-dropdown-item",{nativeOn:{click:function(e){return t.backup()}}},[t._v("数据备份")]),a("el-dropdown-item",{nativeOn:{click:function(e){return t.clear()}}},[t._v("清理缓存")]),a("el-dropdown-item",{nativeOn:{click:function(e){return t.logout()}}},[t._v("退出系统")])],1)],1)]:t._e(),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"320px","append-to-body":!0},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{ref:"post"},[a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"新密码（5-20个字符）",type:"password",maxlength:"20",clearable:""},model:{value:t.dialog.password,callback:function(e){t.$set(t.dialog,"password",e)},expression:"dialog.password"}})],1)],1),a("el-row",[a("el-col",{attrs:{align:"right"}},[a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updatePassword()}}},[t._v("确 定")])],1)],1)],1)],2)},o=[],l=(a("96cf"),a("3b8d")),c=a("4328"),u=a.n(c),d={name:"top",data:function(){return{active:"",info:!1,account:window.localStorage.account,nickname:window.localStorage.nickname,photo:window.localStorage.photo,dialog:{title:"新增",show:!1,edit:!1,password:""}}},mounted:function(){var t=this;this.$nextTick(function(){t.info=!0,window.bus.$on("nav",function(e){return t.active=e})})},methods:{backup:function(){this.$router.push({path:"/backup"})},logout:function(){window.localStorage.removeItem("token"),this.$router.push({path:"/"})},profile:function(){this.dialog.show=!0,this.dialog.edit=!0,this.dialog.title="修改密码",this.dialog.password=""},clear:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"dashboard",method:"clear"},t.next=3,this.$http.post("/api.php",u.a.stringify(e));case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code?this.$message.success("清理成功"):this.$message.error(i.info),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),updatePassword:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.password){t.next=3;break}return this.$message.error("密码不能为空"),t.abrupt("return");case 3:if(!(this.dialog.password.length<5)){t.next=6;break}return this.$message.error("密码不能小于5位"),t.abrupt("return");case 6:return e={token:localStorage.token,class:"user",method:"update_password",id:window.localStorage.id,password:this.dialog.password},t.next=9,this.$http.post("/api.php",u.a.stringify(e));case 9:return a=t.sent,t.prev=10,t.next=13,a.data;case 13:i=t.sent,200==i.code?(this.dialog.show=!1,this.logout()):this.$message.error(i.info),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](10),this.$message.error("网络异常");case 20:case"end":return t.stop()}},t,this,[[10,17]])}));function e(){return t.apply(this,arguments)}return e}()}},p=d,f=(a("4aba"),a("2877")),h=Object(f["a"])(p,r,o,!1,null,null,null),g=h.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"side"},[a("header",[t._v("GUM ADMIN")]),a("el-scrollbar",{attrs:{"wrap-class":"menu-scrollbar","view-class":"view-box"}},[a("el-menu",{staticClass:"el-menu-vertical-side",on:{select:t.select}},[a("el-menu-item",{class:{active:"dashboard"==t.active},attrs:{index:"dashboard"}},[a("i",{staticClass:"icon-monitor"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("控制面板")])]),a("el-menu-item",{class:{active:"post"==t.active},attrs:{index:"post"}},[a("i",{staticClass:"icon-paper"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("文章管理")])]),a("el-menu-item",{class:{active:"tag"==t.active},attrs:{index:"tag"}},[a("i",{staticClass:"icon-tag"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("标签管理")])]),a("el-menu-item",{class:{active:"link"==t.active},attrs:{index:"link"}},[a("i",{staticClass:"icon-paper-clip"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("链接管理")])]),a("el-menu-item",{class:{active:"user"==t.active},attrs:{index:"user"}},[a("i",{staticClass:"icon-head"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("会员管理")])])],1)],1)],1)},v=[],b={name:"side",data:function(){return{active:""}},mounted:function(){var t=this;this.$nextTick(function(){window.bus.$on("nav",function(e){return t.active=e})})},methods:{select:function(t){if("logout"==t)return window.localStorage.removeItem("token"),void this.$router.push({path:"/"});"post-article"==t&&(t="post"),this.$router.push({path:"/"+t})}}},w=b,k=(a("8a72"),Object(f["a"])(w,m,v,!1,null,null,null)),_=k.exports,x={name:"app",components:{top:g,side:_},created:function(){var t=this;window.bus.$on("kick",function(){t.$message.success("您的账号已被他人登陆"),t.$router.push({path:"/"})})}},y=x,$=(a("5d46"),Object(f["a"])(y,n,s,!1,null,null,null)),S=$.exports,C=a("8c4f"),D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box"},[a("h3",[t._v("服务器")]),a("div",{staticClass:"info"},[a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器域名")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.domain))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器时间")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.time))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器引擎")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.software))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("操作系统")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.os))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("PHP版本")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.php_version))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("网站根目录")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.document_root))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("PHP 运行方式")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.run_mode))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("MySQL 版本")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.mysql_version))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("最大上传")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.upload_max_filesize))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("最大POST提交")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.post_max_size))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("硬盘可用空间")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.disk_free_space))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("脚本超时时间")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.max_execution_time))])],1)],1)]),""!=t.info.disable_functions?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box"},[a("h3",[t._v("被禁用的PHP函数")]),a("div",{staticClass:"info"},[t._v(t._s(t.info.disable_functions))])]):t._e(),t.info.extensions?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box"},[a("h3",[t._v("支持的PHP扩展模块")]),a("div",{staticClass:"info"},[t._v(t._s(t.info.extensions.join(",")))])]):t._e()])},O=[],R={name:"dashboard",data:function(){return{first:!0,loading:!1,info:{}}},mounted:function(){var t=this;this.$nextTick(function(){setTimeout(function(t){window.bus.$emit("nav","dashboard")},100),t.getData()})},methods:{getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"dashboard",method:"info"},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.prev=5,t.next=8,a.data;case 8:i=t.sent,200==i.code?(this.info=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),this.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])}));function e(){return t.apply(this,arguments)}return e}()}},j=R,z=(a("5585"),Object(f["a"])(j,D,O,!1,null,"15d58931",null)),E=z.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("el-form",{staticClass:"login-form"},[a("header",[t._v("管理登录")]),a("main",[a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-server",placeholder:"服务器",autocomplete:"off",maxlength:"20",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}})],1),a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-head",placeholder:"账号",autocomplete:"off",maxlength:"20",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.account,callback:function(e){t.account=e},expression:"account"}})],1),a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-lock",autocomplete:"off",placeholder:"密码",type:"password",maxlength:"20",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.loading},on:{click:t.login}},[t._v("立即登录")])],1)],1)])],1)},P=[],N={name:"login",data:function(){return{loading:!1,server:"",account:"",password:""}},mounted:function(){window.localStorage.server?this.server=window.localStorage.server:this.server=window.location.protocol+"//"+window.location.host},methods:{login:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.account){t.next=3;break}return this.$message.error("账号不能为空"),t.abrupt("return");case 3:if(""!=this.password){t.next=6;break}return this.$message.error("密码不能为空"),t.abrupt("return");case 6:return this.loading=!0,e={token:localStorage.token,class:"user",method:"login",account:this.account,password:this.password},window.localStorage.server=this.server,this.$http.defaults.baseURL=window.localStorage.server,t.next=12,this.$http.post("/api.php",u.a.stringify(e));case 12:return a=t.sent,t.prev=13,t.next=16,a.data;case 16:if(i=t.sent,200!=i.code){t.next=32;break}if(255==i.result.level){t.next=22;break}return this.loading=!1,this.$message.error("登陆失败"),t.abrupt("return");case 22:window.localStorage.token=i.token,window.localStorage.id=i.result.id,window.localStorage.account=i.result.account,window.localStorage.nickname=i.result.nickname,window.localStorage.photo=i.result.photo,this.loading=!1,this.$message.success("登陆成功"),this.$router.push({path:"/dashboard"}),t.next=33;break;case 32:404==i.code?(this.loading=!1,this.$message.error("登陆失败")):this.$message.error(i.code);case 33:t.next=38;break;case 35:t.prev=35,t.t0=t["catch"](13),this.$message.error("网络异常");case 38:case"end":return t.stop()}},t,this,[[13,35]])}));function e(){return t.apply(this,arguments)}return e}()}},M=N,F=(a("52ab"),a("56fd"),Object(f["a"])(M,T,P,!1,null,"6ab73b1b",null)),I=F.exports,U=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},J=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"notfound"},[t._v("\n    404\n    "),a("p",[t._v("对不起，找不到页面！")])])])}],q=(a("d9ab"),{}),B=Object(f["a"])(q,U,J,!1,null,"308a9930",null),L=B.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("div",{staticClass:"box zero"},[a("header",[a("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.publish()}}},[t._v("发布")])],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"标签"},model:{value:t.filter.tag_id,callback:function(e){t.$set(t.filter,"tag_id",e)},expression:"filter.tag_id"}},t._l(t.tags,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),a("el-form-item",[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"关键字",maxlength:"10",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterSubmit()}},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","picker-options":t.filter.timeOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期",align:"center"},model:{value:t.filter.time,callback:function(e){t.$set(t.filter,"time",e)},expression:"filter.time"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"已发布",value:"1"}}),a("el-option",{attrs:{label:"未发布",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.items.data,"tooltip-effect":"dark",stripe:""},on:{"selection-change":t.onSelection}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),a("el-table-column",{attrs:{label:"标签",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{"disable-transitions":t.bool,type:"info",size:"small"}},[t._v("\n              "+t._s(e.row.tag_name)+"\n            ")])]}}])}),a("el-table-column",{attrs:{label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return a("span",{staticClass:"title",on:{click:function(a){return t.editData(e.row)}}},[""!=e.row.cover?a("el-popover",{attrs:{trigger:"hover",placement:"right"}},[a("img",{attrs:{src:e.row.cover,align:"absmiddle",width:"200"}}),a("span",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.title))])]):t._e(),""==e.row.cover?a("span",[t._v(t._s(e.row.title))]):t._e(),t._v("\n             \n            "),1==e.row.best?a("el-tag",{attrs:{"disable-transitions":!0,type:"primary",size:"small"}},[t._v("推荐")]):t._e()],1)}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("作者: "+t._s(e.row.author))]),a("p",[t._v("日期: "+t._s(e.row.time))]),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[1==e.row.status?a("el-tag",{attrs:{"disable-transitions":t.bool,type:"success",size:"small"}},[t._v("已发布")]):t._e(),0==e.row.status?a("el-tag",{attrs:{"disable-transitions":t.bool,type:"danger",size:"small"}},[t._v("未发布")]):t._e()],1)])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1),t.items.data&&t.items.data.length>0?a("footer",[a("el-row",{attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.batchDeleteData}},[t._v("批量删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("el-pagination",{attrs:{background:"","current-page":t.pagination.index,layout:"total, prev, pager, next,jumper",total:t.items.total,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1)],1)],1):t._e()],1),t._m(0)])])},H=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"important warn"},[a("strong",[t._v("使用帮助")]),a("br"),t._v("1.当使用了搜索功能后，会保存上一次搜索参数，如果需要清除点击重置按钮即可。\n      "),a("br"),t._v("2.附件功能中的文件即使在页面删除也不会真正删除物理文件，需要清理缓存才会批量删除会未使用的上传文件。\n    ")])}],V=(a("ac6a"),a("f499")),G=a.n(V),W={name:"post",data:function(){return{bool:!0,loading:!1,first:!0,filter:{keyword:"",status:"",time:"",timeOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}},tags:[],items:[],pagination:{size:10,index:1},multipleSelection:[]}},mounted:function(){var t=this;this.$nextTick(function(){setTimeout(function(t){window.bus.$emit("nav","post")},100),window.localStorage.postIndex&&(t.pagination.index=window.localStorage.postIndex>>0),window.localStorage.postFilter&&(t.filter=JSON.parse(window.localStorage.postFilter)),t.getTags(),t.getData()})},methods:{getTags:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"tag",method:"data",data:'{"hot":1000}'},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,this.tags=i.result.hot,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),publish:function(){this.$router.push({path:"/post-form"})},filterSubmit:function(){window.localStorage.postFilter=G()(this.filter),window.localStorage.postIndex=this.pagination.index,this.getData()},filterReset:function(){window.localStorage.removeItem("postFilter"),window.localStorage.removeItem("postIndex"),this.filter.keyword="",this.filter.status="",this.filter.time="",this.filter.tag_id="",this.pagination.index=1,this.getData()},onPagination:function(t){window.localStorage.postIndex=t,this.pagination.index=t,this.getData()},onSelection:function(t){this.multipleSelection=t},batchDeleteData:function(){var t=this;if(0==this.multipleSelection.length)return this.$message.warning("至少选择一个"),!1;var e=this.multipleSelection.map(function(t){return t.id}).join(",");this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark(function a(){var i,n,s;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"post",method:"delete",ids:e},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:s=a.sent,200==s.code?(t.loading=!1,t.getData()):t.$message.error(s.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}},a,this,[[5,12]])})))},editData:function(t){this.$router.push({path:"/post-form",query:{id:t.id}})},deleteData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark(function t(){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"post",method:"delete",ids:e.id},t.next=4,a.$http.get("/api.php",{params:i});case 4:return n=t.sent,t.prev=5,t.next=8,n.data;case 8:s=t.sent,200==s.code?(a.loading=!1,a.getData()):a.$message.error(s.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"post",method:"search",page_index:this.pagination.index,page_size:this.pagination.size},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.time&&(e.begin=+new Date(this.filter.time[0])/1e3>>0,e.end=+new Date(this.filter.time[1])/1e3>>0),""!=this.filter.status&&(e.status=this.filter.status),""!=this.filter.tag_id&&(e.tag_id=this.filter.tag_id),t.next=8,this.$http.get("/api.php",{params:e});case 8:return a=t.sent,t.prev=9,t.next=12,a.data;case 12:i=t.sent,i.result.data.forEach(function(t){t.time=new Date(1e3*t.time).format("yyyy/mm/dd")}),this.items=i.result,this.loading=!1,this.first=!1,t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](9),this.$message.error("网络异常");case 22:case"end":return t.stop()}},t,this,[[9,19]])}));function e(){return t.apply(this,arguments)}return e}()}},Y=W,Q=(a("170a"),Object(f["a"])(Y,A,H,!1,null,"6b757d38",null)),K=Q.exports,X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"layout"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"box"},[a("el-row",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",[a("h3",{staticStyle:{margin:"10px 0 0 0"}},[t._v(t._s(t.edit?"更新文章":"发布文章"))])]),a("el-col",{attrs:{align:"right"}},[t.edit?t._e():a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.saveDraft()}}},[t._v("存草稿")]),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.submit()}}},[t._v(t._s(t.edit?"更新":"发布"))])],1)],1),a("el-form",{ref:"post",attrs:{model:t.post}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{placeholder:"标题（5-30字）",maxlength:"30",clearable:""},model:{value:t.post.title,callback:function(e){t.$set(t.post,"title",e)},expression:"post.title"}})],1),a("editor",{ref:"editor",model:{value:t.post.content,callback:function(e){t.$set(t.post,"content",e)},expression:"post.content"}})],1)],1),a("div",{staticClass:"important warn"},[a("strong",[t._v("上传说明")]),a("br"),t._v("1.缩图上传会自动压缩到600x600。\n          "),a("br"),t._v("2.附件中上传的照片图片会按比例自动压缩到1200x1200的范围。\n          "),a("br"),t._v("3.如果安装了exif扩展可以解决iPhone拍出来的照片自动纠正方向。\n          "),a("br"),t._v("4.上传格式支持jpg/png/gif/pdf/mp4/mov/mp3/psd/json/svg/docx/pptx/xlsx/ppt/xls/doc/zip/rar。\n          "),a("br"),t._v("5.PHP的GD库需要2.1以上版本最佳。\n        ")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.upload.file.loading,expression:"upload.file.loading"}],staticClass:"box"},[a("el-upload",{staticStyle:{float:"right"},attrs:{multiple:"",action:t.upload.file.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.file.success,"before-upload":t.upload.file.before,"on-progress":t.upload.file.progress}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("\n              上传\n              "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1),a("h3",[t._v("附件")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.post.files,stripe:"","show-overflow-tooltip":""}},[a("el-table-column",{attrs:{label:"文件"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{on:{click:function(a){return t.addFile(e.row)}}},[e.row.image?[a("img",{attrs:{src:e.row.url,height:"30",align:"absmiddle"}})]:[t._v(t._s(e.row.name))]],2)}}])}),a("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return["video/mp4"==e.row.type?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.addFile(e.row)}}},[t._v("插入")]):t._e(),e.row.image?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.previewFile(e.row.url)}}},[t._v("预览")]):t._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.deleteFile(e.$index)}}},[t._v("删除")])]}}])})],1),t._l(t.post.files,function(t,e){return a("el-row",{key:e},[a("el-col",{attrs:{span:12}}),a("el-col",{attrs:{span:12}})],1)})],2)]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"box"},[a("h3",[t._v("\n            封面\n            "),""!=t.post.cover?a("a",{staticStyle:{color:"green",cursor:"pointer"},on:{click:function(e){return t.previewFile(t.post.cover)}}},[t._v("预览")]):t._e()]),a("el-upload",{staticClass:"cover",attrs:{action:t.upload.cover.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.cover.success,"before-upload":t.upload.cover.before}},[""!=t.post.cover?a("img",{attrs:{src:t.post.cover,width:"100%",align:"absmiddle"}}):t._e(),""==t.post.cover?a("div",{staticStyle:{display:"block"}},[t._v("上传本地图片")]):t._e()]),""!=t.post.cover?a("div",{staticClass:"delete",on:{click:function(e){return e.stopPropagation(),t.clearCover(e)}}}):t._e()],1),a("div",{staticClass:"box"},[a("h3",[t._v("关联标签")]),t._l(t.tags,function(e,i){return a("el-button",{key:i,staticStyle:{margin:"0 5px 5px 0"},attrs:{round:"",type:e.type},on:{click:function(a){return t.setTag(e)}}},[t._v(t._s(e.name))])})],2),a("div",{staticClass:"box"},[a("h3",[t._v("作者")]),a("el-input",{attrs:{placeholder:"10字内",maxlength:"10",clearable:""},model:{value:t.post.author,callback:function(e){t.$set(t.post,"author",e)},expression:"post.author"}})],1),a("div",{staticClass:"box"},[a("h3",[t._v("关键字")]),a("el-input",{attrs:{placeholder:"例如: GUM,PHP",maxlength:"80",clearable:""},model:{value:t.post.keywords,callback:function(e){t.$set(t.post,"keywords",e)},expression:"post.keywords"}})],1),a("div",{staticClass:"box"},[a("h3",[t._v("描述")]),a("el-input",{attrs:{placeholder:"用于文章摘要，SEO描述",maxlength:"200",type:"textarea",rows:5,clearable:""},model:{value:t.post.description,callback:function(e){t.$set(t.post,"description",e)},expression:"post.description"}})],1),a("div",{staticClass:"box"},[a("h3",[t._v("属性")]),a("el-checkbox",{attrs:{label:"推荐",name:"best"},model:{value:t.post.best,callback:function(e){t.$set(t.post,"best",e)},expression:"post.best"}}),a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:t.post.status,callback:function(e){t.$set(t.post,"status",e)},expression:"post.status"}})],1)])],1)],1)])},Z=[],tt=a("cebc"),et=(a("7f7f"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tinymce-editor"},[a("editor",{attrs:{init:t.init,disabled:t.disabled},on:{onClick:t.onClick},model:{value:t.myValue,callback:function(e){t.myValue=e},expression:"myValue"}})],1)}),at=[],it=a("e562"),nt=a.n(it),st=a("9917"),rt=(a("7913"),a("4ea8"),a("64d8"),a("07d7"),a("2fec"),a("4237"),a("3aea"),a("07d1"),a("84ec"),a("0a9d"),a("f557"),a("9434"),a("bc54"),a("8863"),a("2d33"),a("34de"),a("3154"),a("840a"),a("55a0"),a("c3d7"),{components:{Editor:st["a"]},props:{value:{type:String,default:""},disabled:{type:Boolean,default:!1},plugins:{type:[String,Array],default:"print tabfocus preview fullscreen autolink link charmap lists image imagetools code codesample media table colorpicker textcolor wordcount contextmenu imagetools media paste"},toolbar:{type:[String,Array],default:"formatselect bold italic underline strikethrough  forecolor backcolor | align bullist numlist outdent indent blockquote | link table image media | print  pastetext fullscreen code"}},data:function(){return{init:{convert_urls:!1,codesample_dialog_width:1e3,codesample_dialog_height:400,force_p_newlines:!1,language_url:"tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:"tinymce/skins/lightgray",height:360,plugins:this.plugins,toolbar1:" formatselect fontsizeselect link table image media pastetext code codesample fullscreen print charmap preview imagetools autolink colorpicker",toolbar2:" bold italic underline strikethrough  forecolor backcolor align bullist numlist outdent indent blockquote",branding:!1,menubar:!1,paste_data_images:!0},myValue:this.value}},mounted:function(){nt.a.init({})},methods:{onClick:function(t){this.$emit("onClick",t,nt.a)}},watch:{value:function(t){this.myValue=t},myValue:function(t){this.$emit("input",t)}}}),ot=rt,lt=Object(f["a"])(ot,et,at,!1,null,null,null),ct=lt.exports,ut={components:{editor:ct},data:function(){var t=this;return{edit:!1,loading:!1,draftInterval:null,upload:{data:{token:localStorage.token},cover:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=post&original=600x600",before:function(e){var a="image/jpeg"===e.type,i=e.size/1024/1024<10;return a||t.$message.error("上传头像图片只能是 JPG 格式!"),i||t.$message.error("上传头像图片大小不能超过 10MB!"),a&&i},success:function(e){200==e.code?(t.post.cover=e.result.url,t.post.cover_id=e.result.id):t.$message.error(e.info)}},file:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=post&original=1200x1200",before:function(e){var a=e.size/1024/1024<50;return a||t.$message.error("上传大小不能超过 50MB!"),a},loading:!1,progress:function(e){var a=Math.floor(e.loaded/e.total*100);a<100&&(t.upload.file.loading=!0)},success:function(e){t.upload.file.loading=!1,200==e.code?t.post.files.push(e.result):t.$message.error(e.info)}}},tags:[],races:[],post:{title:"",content:"",author:"",cover:"",cover_id:"",file:"",keywords:"",description:"",best:!1,status:!0,tag_id:0,tag_name:"",files:[]}}},mounted:function(){var t=this;this.$nextTick(function(e){if(setTimeout(function(t){window.bus.$emit("nav","post")},100),t.$route.query.id)t.edit=!0,t.getData();else{var a=localStorage.draft;a&&(a=JSON.parse(a),t.post=a,t.$message.success("已从草稿中恢复")),t.getTags()}})},methods:{saveDraft:function(){""==this.post.title&&""==this.post.content||(window.localStorage.draft=G()(this.post),this.$message.success("草稿已保存"))},setContent:function(t){tinymce.activeEditor.execCommand("mceInsertContent",!1,t),this.post.content=nt.a.activeEditor.getContent()},addFile:function(t){t.image?this.setContent('<img src="'.concat(t.url,'" style="max-width:100%">')):"video/mp4"==t.type?this.setContent('<video controls="controls" width="720" height="480"><source src="'.concat(t.url,'" type="video/mp4" /></video>')):this.setContent('<a href="'.concat(t.url,'">').concat(t.name,"</a>"))},setCover:function(t){this.post.cover=t.url,this.post.cover_id=t.id},clearCover:function(){this.post.cover="",this.post.cover_id=""},previewFile:function(t){window.open(t)},deleteFile:function(t){this.post.files.splice(t,1)},setTag:function(t){this.tags.forEach(function(t){return t.type=""}),t.type="primary",this.post.tag_id=t.id,this.post.tag_name=t.name,2==t.id&&this.getRaces()},getTags:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={token:localStorage.token,class:"tag",method:"data",data:'{"hot":1000}'},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,n=[],i.result.hot.forEach(function(t){s.post.tag_id==t.id?(t.type="primary",s.post.tag_name=t.name):t.type="",n.push(t)}),this.tags=n,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),this.$message.error("网络异常");case 16:case"end":return t.stop()}},t,this,[[0,13]])}));function e(){return t.apply(this,arguments)}return e}(),getBindTags:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={token:localStorage.token,class:"tag",method:"data",data:'{"bind_id":'+this.$route.query.id+',"bind_type":"post"}'},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,n=[],i.result.bind.forEach(function(t){n.push(t)}),this.post.tags=n,this.$forceUpdate(),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$message.error("网络异常");case 17:case"end":return t.stop()}},t,this,[[0,14]])}));function e(){return t.apply(this,arguments)}return e}(),getBindFiles:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={token:localStorage.token,class:"upload",method:"data",data:'{"bind_id":'+this.$route.query.id+',"bind_type":"post"}'},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,200==i.code?(n=[],i.result.bind.forEach(function(t){t.id!=s.post.cover_id&&n.push(t)}),this.post.files=n,this.$forceUpdate()):this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[0,11]])}));function e(){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,e={token:localStorage.token,class:"post",method:"get",id:this.$route.query.id},t.next=5,this.$http.get("/api.php",{params:e});case 5:return a=t.sent,t.next=8,a.data;case 8:i=t.sent,200==i.code?(i.result.files=[],i.result.tags=[],i.result.best=1==i.result.best,i.result.status=1==i.result.status,this.post=i.result,this.loading=!1,this.getTags(),this.getBindFiles()):this.$message.error(i.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),this.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[1,12]])}));function e(){return t.apply(this,arguments)}return e}(),submit:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.post.title){t.next=3;break}return this.$message.error("标题不能为空"),t.abrupt("return");case 3:if(""!=this.post.content){t.next=6;break}return this.$message.error("内容不能为空"),t.abrupt("return");case 6:if(""!=this.post.tag_id){t.next=9;break}return this.$message.error("标签至少选择一个"),t.abrupt("return");case 9:return this.loading=!0,this.post.keywords=this.post.keywords.replace(/，/g,","),e=JSON.parse(G()(this.post)),e.file_ids=e.files.map(function(t){return t.id}).join(","),e.best=e.best?1:0,e.status=e.status?1:0,delete e.files,a=Object(tt["a"])({token:localStorage.token,class:"post",method:"save",id:this.$route.query.id},e),t.next=19,this.$http.post("/api.php",u.a.stringify(a));case 19:return i=t.sent,t.prev=20,t.next=23,i.data;case 23:n=t.sent,200==n.code?(localStorage.removeItem("draft"),this.loading=!1,this.$router.replace({path:"/post"})):this.$message.error(n.code),t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](20),this.$message.error("网络异常");case 30:case"end":return t.stop()}},t,this,[[20,27]])}));function e(){return t.apply(this,arguments)}return e}()}},dt=ut,pt=(a("e3ab"),Object(f["a"])(dt,X,Z,!1,null,null,null)),ft=pt.exports,ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("div",{staticClass:"box zero"},[a("header",[a("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("创建")])],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"ID/邮箱/手机/昵称",maxlength:"10",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterSubmit()}},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","picker-options":t.filter.timeOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期",align:"center"},model:{value:t.filter.time,callback:function(e){t.$set(t.filter,"time",e)},expression:"filter.time"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"已发布",value:"1"}}),a("el-option",{attrs:{label:"未发布",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.items.data,"tooltip-effect":"dark",stripe:""},on:{"selection-change":t.onSelection}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),a("el-table-column",{attrs:{prop:"address",label:"头像",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.photo?a("img",{staticClass:"photo",attrs:{src:e.row.photo,width:"50",height:"50"}}):t._e(),""==e.row.photo?a("div",{staticClass:"photo"},[t._v(t._s(e.row.nickname.substr(0,1)))]):t._e()]}}])}),a("el-table-column",{attrs:{label:"账号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.account)+" ("+t._s(e.row.nickname)+")\n            "),255==e.row.level?a("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("管理员")]):t._e(),e.row.email?[a("br"),t._v("\n              邮箱："+t._s(e.row.email)+"\n              "),e.row.email_verification?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}):t._e()]:t._e(),e.row.tel?[a("br"),t._v("\n              手机："+t._s(e.row.tel)+"\n              "),e.row.tel_verification?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}):t._e()]:t._e()]}}])}),a("el-table-column",{attrs:{prop:"address",label:"登陆",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.login_time)+"\n            "),a("br"),a("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("\n              "+t._s(e.row.login_ip)+"\n            ")])]}}])}),a("el-table-column",{attrs:{prop:"address",label:"注册",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.join_time)+"\n            "),a("br"),a("el-tag",{attrs:{type:"warning",size:"mini"}},[t._v("\n              "+t._s(e.row.join_ip)+"\n            ")])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{type:"success",size:"small"}},[t._v("正常")]):t._e(),0==e.row.status?a("el-tag",{attrs:{type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),e.row.id!=t.id?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row.id)}}},[t._v("删除")]):t._e()]}}])})],1),a("footer",[a("el-row",{attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.batchDeleteData}},[t._v("批量删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("el-pagination",{attrs:{background:"","current-page":t.pagination.index,layout:"total, prev, pager, next,jumper",total:t.items.count,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1)],1)],1)],1)]),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"540px"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{ref:"post",attrs:{model:t.dialog.fields}},[t.dialog.fields.id!=t.id?a("el-form-item",[a("el-radio-group",{model:{value:t.dialog.fields.level,callback:function(e){t.$set(t.dialog.fields,"level",e)},expression:"dialog.fields.level"}},[a("el-radio-button",{attrs:{label:"0"}},[t._v("普通会员")]),a("el-radio-button",{attrs:{label:"255"}},[t._v("管理员")])],1)],1):t._e(),a("el-row",[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"form-photo",style:{"background-image":"url("+this.dialog.fields.photo+")"}},[a("el-upload",{staticClass:"el-upload",attrs:{action:t.upload.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.success,"before-upload":t.upload.before}},[""==t.dialog.fields.photo?a("div",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):t._e()]),""!=t.dialog.fields.photo?a("div",{staticClass:"delete",on:{click:function(e){e.stopPropagation(),t.dialog.fields.photo=""}}}):t._e()],1)]),a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{placeholder:"账号（3-20个由英文字母开头的字母）",maxlength:"20",disabled:t.dialog.edit,readonly:t.dialog.edit,clearable:""},model:{value:t.dialog.fields.account,callback:function(e){t.$set(t.dialog.fields,"account",e)},expression:"dialog.fields.account"}})],1),a("el-form-item",{attrs:{prop:"password"}},[t.dialog.edit?a("el-input",{attrs:{placeholder:"密码（不修改请留空，5-20个字符）",type:"password",maxlength:"20",clearable:""},model:{value:t.dialog.fields.password,callback:function(e){t.$set(t.dialog.fields,"password",e)},expression:"dialog.fields.password"}}):t._e(),t.dialog.edit?t._e():a("el-input",{attrs:{placeholder:"密码（5-20个字符）",type:"password",maxlength:"20",clearable:""},model:{value:t.dialog.fields.password,callback:function(e){t.$set(t.dialog.fields,"password",e)},expression:"dialog.fields.password"}})],1)],1)],1),a("el-form-item",{attrs:{prop:"nickname"}},[a("el-input",{attrs:{placeholder:"昵称（3-10个字）",maxlength:"10",clearable:""},model:{value:t.dialog.fields.nickname,callback:function(e){t.$set(t.dialog.fields,"nickname",e)},expression:"dialog.fields.nickname"}})],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{placeholder:"邮箱地址",maxlength:"100",clearable:""},model:{value:t.dialog.fields.email,callback:function(e){t.$set(t.dialog.fields,"email",e)},expression:"dialog.fields.email"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"tel"}},[a("el-input",{attrs:{placeholder:"手机号码",maxlength:"20",clearable:""},model:{value:t.dialog.fields.tel,callback:function(e){t.$set(t.dialog.fields,"tel",e)},expression:"dialog.fields.tel"}})],1)],1)],1)],1),a("el-row",[a("el-col",{staticStyle:{"padding-top":"10px","text-align":"left"},attrs:{span:14}},[a("el-checkbox",{attrs:{label:"手机验证",name:"best"},model:{value:t.dialog.fields.tel_verification,callback:function(e){t.$set(t.dialog.fields,"tel_verification",e)},expression:"dialog.fields.tel_verification"}}),a("el-checkbox",{attrs:{label:"邮件验证",name:"best"},model:{value:t.dialog.fields.email_verification,callback:function(e){t.$set(t.dialog.fields,"email_verification",e)},expression:"dialog.fields.email_verification"}}),a("el-checkbox",{attrs:{label:"正常",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}})],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:10}},[a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("确 定")])],1)],1)],1)],1)},gt=[],mt={name:"user",data:function(){var t=this;return{id:null,loading:!1,first:!0,filter:{keyword:"",status:"",time:"",timeOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}},upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=user&original=200x200",data:{token:localStorage.token},before:function(e){var a="image/jpeg"===e.type,i=e.size/1024/1024<5;return a||t.$message.error("上传头像图片只能是 JPG 格式!"),i||t.$message.error("上传头像图片大小不能超过 2MB!"),a&&i},success:function(e){200==e.code?(t.dialog.fields.photo=e.result.url,t.dialog.fields.photo_id=e.result.id):t.$message.error(e.info)}},dialog:{title:"新增",show:!1,edit:!1,fields:{photo:"",photo_id:"",account:"",password:"",level:"0",nickname:"",email:"",email_verification:!1,tel:"",tel_verification:!1,status:!0}},items:[],pagination:{size:10,index:1},multipleSelection:[]}},mounted:function(){this.id=window.localStorage.id,setTimeout(function(t){window.bus.$emit("nav","user")},100),this.getData()},methods:{filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.filter.time="",this.pagination.index=1,this.getData()},onPagination:function(t){this.pagination.index=t,this.getData()},onSelection:function(t){this.multipleSelection=t},batchDeleteData:function(){var t=this;if(0==this.multipleSelection.length)return this.$message.warning("至少选择一个"),!1;var e=this.multipleSelection.map(function(t){return t.id}).join(",");this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark(function a(){var i,n,s;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"user",method:"delete",ids:e},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:s=a.sent,200==s.code?(t.loading=!1,t.getData()):t.$message.error(s.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}},a,this,[[5,12]])})))},addData:function(){this.dialog.show=!0,this.dialog.edit=!1,this.dialog.title="创建会员",this.dialog.fields={photo:"",photo_id:"",account:"",password:"",level:"0",nickname:"",email:"",email_verification:!1,tel:"",tel_verification:!1,status:!0}},editData:function(t){t.status=1==t.status,this.dialog.show=!0,this.dialog.edit=!0,this.dialog.title="编辑会员",this.dialog.fields=t},deleteData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark(function t(){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"user",method:"delete",ids:e},t.next=4,a.$http.get("/api.php",{params:i});case 4:return n=t.sent,t.prev=5,t.next=8,n.data;case 8:s=t.sent,200==s.code?(a.loading=!1,a.getData()):a.$message.error(s.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"user",method:"search",page_index:this.pagination.index,page_size:this.pagination.size},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.time&&(e.begin=+new Date(this.filter.time[0])/1e3>>0,e.end=+new Date(this.filter.time[1])/1e3>>0),""!=this.filter.status&&(e.status=this.filter.status),t.next=7,this.$http.get("/api.php",{params:e});case 7:return a=t.sent,t.prev=8,t.next=11,a.data;case 11:i=t.sent,200==i.code?(i.result.data.forEach(function(t){t.tel_verification=1==t.tel_verification,t.email_verification=1==t.email_verification,t.join_time=new Date(1e3*t.join_time).format("yyyy/mm/dd h:i"),t.login_time=new Date(1e3*t.login_time).format("yyyy/mm/dd h:i")}),this.items=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](8),this.$message.error("网络异常");case 18:case"end":return t.stop()}},t,this,[[8,15]])}));function e(){return t.apply(this,arguments)}return e}(),saveData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.fields.account){t.next=3;break}return this.$message.error("账号不能为空"),t.abrupt("return");case 3:if(""!=this.dialog.fields.nickname){t.next=6;break}return this.$message.error("昵称不能为空"),t.abrupt("return");case 6:if(this.dialog.edit||""!=this.dialog.fields.password){t.next=9;break}return this.$message.error("密码不能为空"),t.abrupt("return");case 9:if(this.dialog.edit||!(this.dialog.fields.password.length<5)){t.next=12;break}return this.$message.error("密码不能小于5位"),t.abrupt("return");case 12:return e=JSON.parse(G()(this.dialog.fields)),e.email_verification=e.email_verification?1:0,e.tel_verification=e.tel_verification?1:0,e.status=e.status?1:0,a=Object(tt["a"])({token:localStorage.token,class:"user",method:"save",id:this.$route.query.id},e),t.next=19,this.$http.post("/api.php",u.a.stringify(a));case 19:return i=t.sent,t.prev=20,t.next=23,i.data;case 23:n=t.sent,200==n.code?(this.dialog.show=!1,this.pagination.index=1,this.getData()):this.$message.error(n.code),t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](20),this.$message.error("网络异常");case 30:case"end":return t.stop()}},t,this,[[20,27]])}));function e(){return t.apply(this,arguments)}return e}()}},vt=mt,bt=(a("a833"),Object(f["a"])(vt,ht,gt,!1,null,"16d9309c",null)),wt=bt.exports,kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("div",{staticClass:"box zero"},[a("header",[a("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("新增")])],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"关键字"},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.result.data,"tooltip-effect":"dark"},on:{"selection-change":t.onSelection}},[a("el-table-column",{attrs:{align:"center",label:"编号",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.id))]}}])}),a("el-table-column",{attrs:{label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),a("el-table-column",{attrs:{align:"center",label:"标签",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.tag))]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"success",size:"small"}},[t._v("启用")]):t._e(),0==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.moveUp(e.$index)}}},[t._v("上移")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.moveDown(e.$index)}}},[t._v("下移")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1),t.result.data&&t.result.data.length>0&&t.result.total>t.pagination.size?a("footer",[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:t.result.total,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1):t._e()],1),t._m(0)]),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"30%"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{placeholder:"名称"},model:{value:t.dialog.fields.name,callback:function(e){t.$set(t.dialog.fields,"name",e)},expression:"dialog.fields.name"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"标签（可选）"},model:{value:t.dialog.fields.tag,callback:function(e){t.$set(t.dialog.fields,"tag",e)},expression:"dialog.fields.tag"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"启用",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}}),t._v(" \n      "),a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("确 定")])],1)],1)],1)},_t=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"important warn"},[a("strong",[t._v("使用帮助")]),a("br"),t._v("标签中的标签字段是用于二次开发时候使用的，比如在首页有些标签需要显示图片列表可以用标签字段值进行区别显示。\n    ")])}],xt={data:function(){return{loading:!1,first:!0,filter:{keyword:"",status:""},dialog:{title:"修改",show:!1,fields:{name:"",tag:"",status:!0}},result:{},pagination:{size:1e5,index:1},multipleSelection:[]}},mounted:function(){setTimeout(function(t){window.bus.$emit("nav","tag")},100),this.getData()},methods:{filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.filter.time="",this.pagination.index=1,this.getData()},onPagination:function(t){this.pagination.current=t,this.getData()},onSelection:function(t){this.multipleSelection=t},onSelectionToggle:function(){this.$refs.table.toggleAllSelection()},addData:function(){this.dialog={title:"新增",show:!0,fields:{name:"",tag:"",status:!0}}},editData:function(t){var e=JSON.parse(G()(t));e.status=1==e.status,this.dialog={title:"编辑",show:!0,fields:e}},deleteData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark(function t(){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"tag",method:"delete",id:e.id},t.next=4,a.$http.get("/api.php",{params:i});case 4:return n=t.sent,t.prev=5,t.next=8,n.data;case 8:s=t.sent,200==s.code?(a.loading=!1,a.getData()):a.$message.error(s.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"tag",method:"search",page_index:this.pagination.index,page_size:this.pagination.size},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.status&&(e.status=this.filter.status),t.next=6,this.$http.get("/api.php",{params:e});case 6:return a=t.sent,t.prev=7,t.next=10,a.data;case 10:i=t.sent,200==i.code?(this.result=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),this.$message.error("网络异常");case 17:case"end":return t.stop()}},t,this,[[7,14]])}));function e(){return t.apply(this,arguments)}return e}(),saveData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.name){t.next=3;break}return this.$message.error("标签不能为空"),t.abrupt("return");case 3:return this.loading=!0,e=JSON.parse(G()(this.dialog.fields)),e.status=e.status?1:0,a=Object(tt["a"])({token:localStorage.token,class:"tag",method:"save"},e),t.next=9,this.$http.get("/api.php",{params:a});case 9:return i=t.sent,t.prev=10,t.next=13,i.data;case 13:n=t.sent,200==n.code?(this.loading=!1,this.dialog.show=!1,this.getData()):this.$message.error(n.code),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](10),this.$message.error("网络异常");case 20:case"end":return t.stop()}},t,this,[[10,17]])}));function e(){return t.apply(this,arguments)}return e}(),swap:function(t,e,a){return t[a]=t.splice(e,1,t[a])[0],t},moveUp:function(t){0!=t&&(this.swap(this.result.data,t,t-1),this.updateSort())},moveDown:function(t){t!=this.result.data.length-1&&(this.swap(this.result.data,t,t+1),this.updateSort())},updateSort:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"tag",method:"update_sort",ids:this.result.data.map(function(t){return t.id}).join(",")},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code||this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}()}},yt=xt,$t=(a("93c3"),Object(f["a"])(yt,kt,_t,!1,null,"66a68649",null)),St=$t.exports,Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("div",{staticClass:"box zero"},[a("header",[a("el-form",{staticClass:"filter-form",attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("新增")])],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"关键字(标题/网址/标签)"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterSubmit()}},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.result.data}},[a("el-table-column",{attrs:{label:"图片",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.image?a("div",{staticClass:"empty",style:{"background-image":"url("+e.row.image+")"},on:{click:function(a){return t.open(e.row.image)}}}):t._e(),""==e.row.image?a("div",{staticClass:"empty"},[t._v("?")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"标题",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b",[t._v(t._s(e.row.title))])]}}])}),a("el-table-column",{attrs:{label:"网址"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.url))]}}])}),a("el-table-column",{attrs:{label:"标签",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b",[t._v(t._s(e.row.tag))])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"success",size:"small"}},[t._v("启用")]):t._e(),0==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.moveUp(e.$index)}}},[t._v("上移")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return t.moveDown(e.$index)}}},[t._v("下移")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1),t.result.data&&t.result.data.length>0&&t.result.total>t.pagination.size?a("footer",[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:t.result.total,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1):t._e()],1),t._m(0)]),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"40%"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"image",style:{"background-image":"url("+this.dialog.fields.image+")"}},[a("el-upload",{staticClass:"el-upload",attrs:{action:t.upload.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.success,"before-upload":t.upload.before}},[a("div",{staticClass:"placeholder"},[""==t.dialog.fields.image?[t._v("图片(可选)")]:t._e()],2)]),""!=t.dialog.fields.image?a("div",{staticClass:"delete",on:{click:function(e){e.stopPropagation(),t.dialog.fields.image=""}}}):t._e()],1)]),a("el-col",{attrs:{span:18}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"标题"},model:{value:t.dialog.fields.title,callback:function(e){t.$set(t.dialog.fields,"title",e)},expression:"dialog.fields.title"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"网址"},model:{value:t.dialog.fields.url,callback:function(e){t.$set(t.dialog.fields,"url",e)},expression:"dialog.fields.url"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"标签（可选）",maxlength:"10"},model:{value:t.dialog.fields.tag,callback:function(e){t.$set(t.dialog.fields,"tag",e)},expression:"dialog.fields.tag"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}}),t._v(" \n      "),a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("确 定")])],1)],1)],1)},Dt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"important warn"},[a("strong",[t._v("使用帮助")]),a("br"),t._v("链接标签是用于二次开发模板的时候用的，可以做轮换图片模块等。\n    ")])}],Ot={data:function(){var t=this;return{loading:!1,first:!0,upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=link",data:{token:localStorage.token},before:function(e){var a="image/jpeg"===e.type||"image/png"===e.type||"image/svg+xml"===e.type||"image/gif"===e.type,i=e.size/1024/1024<1;return a||t.$message.error("上传图片格式错误!"),i||t.$message.error("上传图片大小不能超过 1MB!"),a&&i},success:function(e){200==e.code?(t.dialog.fields.image_id=e.result.id,t.dialog.fields.image=e.result.url):t.$message.error(e.info)}},filter:{keyword:"",status:""},dialog:{title:"新增",show:!1,fields:{image:"",image_id:"",title:"",url:"",tag:"",status:!0}},result:{},pagination:{size:1e5,index:1}}},computed:{},mounted:function(){setTimeout(function(){window.bus.$emit("nav","link")},100),this.getData()},methods:{open:function(t){window.open(t)},filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.pagination.index=1,this.getData()},onPagination:function(t){this.pagination.index=t,this.getData()},getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"link",method:"search",page_size:this.pagination.size,page_index:this.pagination.index},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.status&&(e.status=this.filter.status),t.next=6,this.$http.get("/api.php",{params:e});case 6:return a=t.sent,t.prev=7,t.next=10,a.data;case 10:i=t.sent,200==i.code?(i.result.data.forEach(function(t){t.status=1==t.status}),this.result=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),this.$message.error("网络异常");case 17:case"end":return t.stop()}},t,this,[[7,14]])}));function e(){return t.apply(this,arguments)}return e}(),addData:function(){this.dialog={title:"添加",show:!0,fields:{image:"",image_id:"",title:"",url:"",tag:"",status:!0}}},editData:function(t){var e=JSON.parse(G()(t));e.status=1==e.status,this.dialog={title:"编辑",show:!0,fields:Object(tt["a"])({},e)}},deleteData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark(function t(){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"link",method:"delete",id:e.id},t.next=4,a.$http.get("/api.php",{params:i});case 4:return n=t.sent,t.prev=5,t.next=8,n.data;case 8:s=t.sent,200==s.code?(a.loading=!1,a.getData()):a.$message.error(s.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),saveData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.fields.title){t.next=3;break}return this.$message.error("标题不能为空"),t.abrupt("return");case 3:if(""!=this.dialog.fields.url){t.next=6;break}return this.$message.error("网址不能为空"),t.abrupt("return");case 6:return this.loading=!0,e=JSON.parse(G()(this.dialog.fields)),e.status=e.status?1:0,a=Object(tt["a"])({token:localStorage.token,class:"link",method:"save"},e),t.next=12,this.$http.get("/api.php",{params:a});case 12:return i=t.sent,t.prev=13,t.next=16,i.data;case 16:n=t.sent,200==n.code?(this.loading=!1,this.dialog.show=!1,this.getData()):this.$message.error(n.code),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](13),this.$message.error("网络异常");case 23:case"end":return t.stop()}},t,this,[[13,20]])}));function e(){return t.apply(this,arguments)}return e}(),swap:function(t,e,a){return t[a]=t.splice(e,1,t[a])[0],t},moveUp:function(t){0!=t&&(this.swap(this.result.data,t,t-1),this.updateSort())},moveDown:function(t){t!=this.result.data.length-1&&(this.swap(this.result.data,t,t+1),this.updateSort())},updateSort:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"link",method:"update_sort",ids:this.result.data.map(function(t){return t.id}).join(",")},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code||this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}()}},Rt=Ot,jt=(a("b9b6"),Object(f["a"])(Rt,Ct,Dt,!1,null,"5fed699d",null)),zt=jt.exports,Et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("div",{staticClass:"box"},[a("el-row",[a("el-col",{attrs:{span:10}},[a("b",[t._v("数据备份/还原")])]),a("el-col",{attrs:{span:14,align:"right"}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){return t.backup()}}},[t._v("备份")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.items}},[a("el-table-column",{attrs:{label:"时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.time))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success"},on:{click:function(a){return t.restore(e.row.name)}}},[t._v("还原")])]}}])})],1)],1),t._m(0)])])},Tt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"important warn"},[a("strong",[t._v("使用说明")]),a("br"),t._v("还原数据库会覆盖现有的数据库，请谨慎操作。\n    ")])}],Pt={name:"total",data:function(){return{loading:!1,first:!0,items:[]}},computed:{},mounted:function(){setTimeout(function(t){window.bus.$emit("nav","backup")},100),this.getData()},methods:{getData:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"backup",method:"search"},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.prev=5,t.next=8,a.data;case 8:i=t.sent,200==i.code?(this.items=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),this.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])}));function e(){return t.apply(this,arguments)}return e}(),backup:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"backup",method:"backup"},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code?(this.getData(),this.$message.success("备份成功")):this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),restore:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确定要还原数据库吗？还原后现有的数据库将会被覆盖！").then(Object(l["a"])(regeneratorRuntime.mark(function t(){var i,n,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i={token:localStorage.token,class:"backup",method:"restore",file:e},t.next=3,a.$http.get("/api.php",{params:i});case 3:return n=t.sent,t.prev=4,t.next=7,n.data;case 7:s=t.sent,200==s.code?(a.getData(),a.$message.success("还原成功")):a.$message.error("还原失败"),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),a.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},Nt=Pt,Mt=Object(f["a"])(Nt,Et,Tt,!1,null,null,null),Ft=Mt.exports;i["default"].use(C["a"]);var It=new C["a"]({routes:[{path:"*",component:L},{path:"/",component:I},{path:"/dashboard",component:E},{path:"/post",component:K},{path:"/post-form",component:ft},{path:"/user",component:wt},{path:"/tag",component:St},{path:"/link",component:zt},{path:"/backup",component:Ft}]}),Ut=a("5c96"),Jt=a.n(Ut),qt=(a("0fae"),a("fe3c")),Bt=a.n(qt),Lt=a("bc3a"),At=a.n(Lt);i["default"].use(Jt.a),Bt.a.prototype.focus=function(t){var e;/ios/g.test(window.navigator.userAgent.toLowerCase())&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.focus(),t.setSelectionRange(e,e)):t.focus()},window.localStorage.server&&(At.a.defaults.baseURL=window.localStorage.server),At.a.defaults.timeout=6e4,At.a.defaults.headers["Content-Type"]="application/x-www-form-urlencoded",At.a.interceptors.response.use(function(t){return 403==t.data.code?(window.localStorage.removeItem("token"),void window.bus.$emit("kick")):t},function(t){console.log(t)}),i["default"].prototype.$http=At.a,i["default"].config.productionTip=!1,window.bus=new i["default"],new i["default"]({router:It,render:function(t){return t(S)}}).$mount("#app"),Date.prototype.format=function(t){var e=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i={"y+":this.getFullYear(),"m+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"i+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),n:this.getMilliseconds(),M:e[this.getMonth()],W:a[this.getDay()]};for(var n in i)new RegExp("("+n+")").test(t)&&(t="y+"==n?t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)):t.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t}},"56fd":function(t,e,a){"use strict";var i=a("aa59"),n=a.n(i);n.a},"5d46":function(t,e,a){"use strict";var i=a("91bd"),n=a.n(i);n.a},"6b85":function(t,e,a){},7309:function(t,e,a){},"8a72":function(t,e,a){"use strict";var i=a("6b85"),n=a.n(i);n.a},"8ce4":function(t,e,a){},"913e":function(t,e,a){},"91bd":function(t,e,a){},"93c3":function(t,e,a){"use strict";var i=a("9595"),n=a.n(i);n.a},9595:function(t,e,a){},a02a:function(t,e,a){},a833:function(t,e,a){"use strict";var i=a("7309"),n=a.n(i);n.a},aa59:function(t,e,a){},b9b6:function(t,e,a){"use strict";var i=a("913e"),n=a.n(i);n.a},d9ab:function(t,e,a){"use strict";var i=a("a02a"),n=a.n(i);n.a},da00:function(t,e,a){},e3ab:function(t,e,a){"use strict";var i=a("3995"),n=a.n(i);n.a},ffc8:function(t,e,a){}});