(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)r=o[d],s[r]&&p.push(s[r][0]),s[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={app:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0517":function(t,e,a){},"18de":function(t,e,a){"use strict";var i=a("51bb"),s=a.n(i);s.a},"199b":function(t,e,a){},"291a":function(t,e,a){"use strict";var i=a("199b"),s=a.n(i);s.a},"2d06":function(t,e,a){},3995:function(t,e,a){},"51bb":function(t,e,a){},"52ab":function(t,e,a){"use strict";var i=a("da00"),s=a.n(i);s.a},"56d7":function(t,e,a){"use strict";a.r(e);a("a481"),a("3b2b");var i=a("795b"),s=a.n(i),n=(a("cadf"),a("551c"),a("f751"),a("097d"),a("2b0e")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view",{staticClass:"router",class:{full:"/login"==t.$route.path||"/"==t.$route.path}}),"/login"!=t.$route.path&&"/"!=t.$route.path?a("side"):t._e(),a("el-backtop",{attrs:{target:"body"}})],1)},o=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"side"},[a("div",{staticClass:"info"},[""!=t.photo?a("span",{staticClass:"photo",style:{"background-image":"url("+this.photo+")"}}):t._e(),""==t.photo?a("span",{staticClass:"photo"},[t._v(t._s(t.nickname.substr(0,1)))]):t._e(),a("div",{staticClass:"account"},[t._v(t._s(t.nickname))]),a("div",{staticClass:"other"},[a("span",{on:{click:function(e){return t.profile()}}},[t._v("修改密码")]),a("span",{on:{click:function(e){return t.clear()}}},[t._v("清理缓存")])])]),a("el-scrollbar",{attrs:{"wrap-class":"menu-scrollbar","view-class":"view-box"}},[a("el-menu",{staticClass:"el-menu-vertical-side",on:{select:t.select}},[a("el-menu-item",{class:{active:"dashboard"==t.active},attrs:{index:"dashboard"}},[a("i",{staticClass:"icon-monitor"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("首页")])]),t._l(t.permissions,function(e){return a("el-menu-item",{key:e.key,class:{active:t.active==e.key},attrs:{index:e.key}},[a("i",{class:[e.icon]}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))])])}),a("el-menu-item",{class:{active:"logout"==t.active},attrs:{index:"logout"}},[a("i",{staticClass:"icon-outbox"}),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("退出")])])],2)],1),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"320px","append-to-body":!0},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{ref:"post"},[a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"旧密码",type:"password",maxlength:"20",clearable:"","show-password":""},model:{value:t.dialog.oldPassword,callback:function(e){t.$set(t.dialog,"oldPassword",e)},expression:"dialog.oldPassword"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"新密码（5-20个字符）",type:"password",maxlength:"20",clearable:"","show-password":""},model:{value:t.dialog.newPassword,callback:function(e){t.$set(t.dialog,"newPassword",e)},expression:"dialog.newPassword"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"确认密码",type:"password",maxlength:"20",clearable:"","show-password":""},model:{value:t.dialog.confirmPassword,callback:function(e){t.$set(t.dialog,"confirmPassword",e)},expression:"dialog.confirmPassword"}})],1)],1),a("el-row",[a("el-col",{attrs:{align:"right"}},[a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.updatePassword()}}},[t._v("确 定")])],1)],1)],1)],1)},c=[],u=(a("96cf"),a("3b8d")),d=(a("6762"),a("2fdb"),[{name:"文章",key:"post",icon:"icon-paper"},{name:"标签",key:"tag",icon:"icon-tag"},{name:"链接",key:"link",icon:"icon-link"},{name:"会员",key:"user",icon:"icon-head"},{name:"数据备份/还原",key:"backup",icon:"icon-paper"},{name:"设置",key:"config",icon:"icon-cog",super:!0}]),p=a("4328"),f=a.n(p),h={name:"side",data:function(){var t=atob(window.localStorage.permission);return{permissions:"super"!=t?d.filter(function(e){return t.includes(e.key)}):d,active:"",info:!1,account:window.localStorage.account,nickname:window.localStorage.nickname,photo:window.localStorage.photo,dialog:{title:"",show:!1,edit:!1,oldPassword:"",newPassword:"",confirmPassword:""}}},mounted:function(){var t=this;this.$nextTick(function(){t.info=!0,window.bus.$on("nav",function(e){return t.active=e})})},methods:{select:function(t){if("logout"==t)return window.localStorage.removeItem("token"),void this.$router.push({path:"/"});"post-article"==t&&(t="post"),this.$router.push({path:"/"+t})},backup:function(){this.$router.push({path:"/backup"})},logout:function(){window.localStorage.removeItem("token"),this.$router.push({path:"/"})},profile:function(){this.dialog.show=!0,this.dialog.edit=!0,this.dialog.title="修改密码",this.dialog.password=""},clear:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"dashboard",method:"clear"},t.next=3,this.$http.post("/api.php",f.a.stringify(e));case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code?this.$message.success("清理成功"):this.$message.error(i.info),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),updatePassword:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.oldPassword){t.next=3;break}return this.$message.warning("旧密码不能为空"),t.abrupt("return");case 3:if(""!=this.dialog.newPassword){t.next=6;break}return this.$message.warning("新密码不能为空"),t.abrupt("return");case 6:if(this.dialog.newPassword==this.dialog.confirmPassword){t.next=9;break}return this.$message.warning("两次输入的密码不一致"),t.abrupt("return");case 9:if(!(this.dialog.newPassword.length<5)){t.next=12;break}return this.$message.warning("密码不能小于5位"),t.abrupt("return");case 12:return e={token:localStorage.token,class:"user",method:"update_password",id:window.localStorage.id,old:this.dialog.oldPassword,new:this.dialog.newPassword},t.next=15,this.$http.post("/api.php",f.a.stringify(e));case 15:return a=t.sent,t.prev=16,t.next=19,a.data;case 19:i=t.sent,200==i.code?(this.dialog.show=!1,this.logout()):this.$message.error(i.info),t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](16),this.$message.error("网络异常");case 26:case"end":return t.stop()}},t,this,[[16,23]])}));function e(){return t.apply(this,arguments)}return e}()}},g=h,m=(a("8a72"),a("2877")),v=Object(m["a"])(g,l,c,!1,null,null,null),b=v.exports,w={name:"app",components:{side:b},created:function(){var t=this;window.bus.$on("kick",function(){t.$router.push({path:"/"})})}},k=w,_=(a("5d46"),Object(m["a"])(k,r,o,!1,null,null,null)),y=_.exports,x=a("8c4f"),$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"layout"},[a("div",{staticClass:"box"},[t._m(0),a("div",{staticClass:"box-content"},[a("div",{staticClass:"info"},[a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器域名")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{type:"primary",href:t.domain,target:"_blank"}},[t._v(t._s(t.info.domain))])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器时间")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.time))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器引擎")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.software))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("服务器系统")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.os))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("PHP版本")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{type:"primary",href:"https://php.net",target:"_blank"}},[t._v(t._s(t.info.php_version))])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("PHP 运行方式")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.run_mode))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("MySQL 版本")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.mysql_version))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("最大上传")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.upload_max_filesize))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("最大POST提交")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.post_max_size))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("硬盘可用空间")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.disk_free_space))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("脚本超时时间")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.max_execution_time))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("网站根目录")]),a("el-col",{attrs:{span:20}},[t._v(t._s(t.info.document_root))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("网站默认主题")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{type:"success",title:"点击切换主题"},on:{click:function(e){t.dialog.show=!0}}},[t._v(t._s(t.info.theme_dir))])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[t._v("网站程序版本")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{title:"获取最新版本",type:"danger",href:"https://github.com/jinzhe/gum",target:"_blank"}},[t._v(t._s(t.info.version))])],1)],1),""!=t.version?a("el-row",[a("el-col",{attrs:{span:4}},[t._v("最新程序版本")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{title:"获取最新版本",type:"warning",href:"https://github.com/jinzhe/gum",target:"_blank"}},[t._v(t._s(t.version))])],1)],1):t._e()],1)])]),""!=t.info.disable_functions?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box"},[t._m(1),a("div",{staticClass:"box-content"},[a("div",{staticClass:"info"},[t._v(t._s(t.info.disable_functions))])])]):t._e(),t.info.extensions?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box"},[t._m(2),a("div",{staticClass:"box-content"},[a("div",{staticClass:"info"},[t._v(t._s(t.info.extensions.join(",")))])])]):t._e()]),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.dialog.loading,expression:"dialog.loading"}],attrs:{title:"默认主题",visible:t.dialog.show,width:"50%"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[t._l(t.info.theme_dirs,function(e){return a("el-button",{key:e,class:{"el-button--primary":e==t.info.theme_dir},nativeOn:{click:function(a){return t.setTheme(e)}}},[t._v(t._s(e))])}),a("br"),a("br"),a("div",{staticClass:"important warn"},[a("strong",[t._v("说明")]),a("br"),t._v("切换后会自动将主题配置文件中的config全局设置变量导入到数据库中，如果数据库中已经存在则不会导入。\n    ")])],2)],1)},S=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-header"},[t._v("\n        服务器\n        "),a("p",[t._v("服务器基本信息、程序版本、主题等")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-header"},[t._v("\n        禁用函数\n        "),a("p",[t._v("被禁用的PHP函数")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-header"},[t._v("\n        扩展模块\n        "),a("p",[t._v("支持的PHP扩展模块")])])}],C={name:"dashboard",data:function(){return{domain:localStorage.server,first:!0,loading:!1,dialog:{show:!1,loading:!1},version:"",info:{}}},mounted:function(){var t=this;this.$nextTick(function(){setTimeout(function(t){window.bus.$emit("nav","dashboard")},100),t.getData(),t.getVersion()})},methods:{getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"dashboard",method:"info"},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,200==i.code?(this.info=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getVersion:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return{class:"dashboard",method:"version"},t.next=3,this.$http.get("https://zee.kim/api.php?class=dashboard&method=version");case 3:return e=t.sent,t.next=6,e.data;case 6:a=t.sent,200==a.code&&(this.version=a.version);case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),setTheme:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.dialog.loading=!0,a={token:localStorage.token,class:"dashboard",method:"theme",dir:e},t.next=4,this.$http.get("/api.php",{params:a});case 4:return i=t.sent,t.next=7,i.data;case 7:s=t.sent,200==s.code?(this.getData(),this.dialog.show=!1,this.dialog.loading=!1):this.$message.error(s.code);case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},D=C,O=(a("636a"),Object(m["a"])(D,$,S,!1,null,"04f92e93",null)),j=O.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("el-form",{staticClass:"login-form"},[a("header",[t._v("管理登录")]),a("main",[a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-server",placeholder:"服务器",autocomplete:"off",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}})],1),a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-head",placeholder:"账号",autocomplete:"off",maxlength:"20",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.account,callback:function(e){t.account=e},expression:"account"}})],1),a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-lock",autocomplete:"off",placeholder:"密码",type:"password",maxlength:"20",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.loading},on:{click:t.login}},[t._v("立即登录")])],1)],1)])],1)},z=[],P={name:"login",data:function(){return{loading:!1,server:"",account:"",password:""}},mounted:function(){window.localStorage.server?this.server=window.localStorage.server:this.server=window.location.protocol+"//"+window.location.host},methods:{login:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.account){t.next=3;break}return this.$message.error("账号不能为空"),t.abrupt("return");case 3:if(""!=this.password){t.next=6;break}return this.$message.error("密码不能为空"),t.abrupt("return");case 6:return this.loading=!0,e={token:localStorage.token,class:"user",method:"login",account:this.account,password:this.password},window.localStorage.server=this.server,this.$http.defaults.baseURL=window.localStorage.server,t.next=12,this.$http.post("/api.php",f.a.stringify(e));case 12:return a=t.sent,t.prev=13,t.next=16,a.data;case 16:if(i=t.sent,200!=i.code){t.next=33;break}if(255==i.result.level){t.next=22;break}return this.loading=!1,this.$message.error("登陆失败"),t.abrupt("return");case 22:window.localStorage.token=i.token,window.localStorage.id=i.result.id,window.localStorage.account=i.result.account,window.localStorage.nickname=i.result.nickname,window.localStorage.photo=i.result.photo,window.localStorage.permission=btoa(i.result.permission),this.loading=!1,this.$message.success("登陆成功"),this.$router.push({path:"/dashboard"}),t.next=34;break;case 33:404==i.code?(this.loading=!1,this.$message.error("登陆失败")):(this.$message.error(i.code),this.loading=!1);case 34:t.next=40;break;case 36:t.prev=36,t.t0=t["catch"](13),this.$message.error("服务器无法链接"),this.loading=!1;case 40:case"end":return t.stop()}},t,this,[[13,36]])}));function e(){return t.apply(this,arguments)}return e}()}},E=P,T=(a("52ab"),a("589b"),Object(m["a"])(E,R,z,!1,null,"52185fdd",null)),N=T.exports,I=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},M=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"notfound"},[t._v("\n    404\n    "),a("p",[t._v("对不起，找不到页面！")])])])}],F=(a("d9ab"),{}),U=Object(m["a"])(F,I,M,!1,null,"308a9930",null),J=U.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("h1",[t._v("文章")]),a("p",[t._v("\n          可作为发布新闻、通知、笔记等信息。\n          "),a("br"),t._v("搜索后，会保存上一次搜索参数，如果需要清除点击重置按钮即可。\n        ")])]),a("el-col",{attrs:{span:12,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.publish()}}},[t._v("添加")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header noborder"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"标签"},model:{value:t.filter.tag_id,callback:function(e){t.$set(t.filter,"tag_id",e)},expression:"filter.tag_id"}},t._l(t.tags,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"关键字",maxlength:"10",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterSubmit()}},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","picker-options":t.filter.timeOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期",align:"center"},model:{value:t.filter.time,callback:function(e){t.$set(t.filter,"time",e)},expression:"filter.time"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"已发布",value:"1"}}),a("el-option",{attrs:{label:"未发布",value:"0"}})],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.items.data,"tooltip-effect":"dark",stripe:""},on:{"selection-change":t.onSelection}},[a("el-table-column",{attrs:{type:"selection",width:"30"}}),a("el-table-column",{attrs:{label:"标签",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{"disable-transitions":t.bool,type:"info",size:"small"}},[t._v("\n                "+t._s(e.row.tag_name)+"\n              ")])]}}])}),a("el-table-column",{attrs:{label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return a("span",{staticClass:"title",on:{click:function(a){return t.editData(e.row)}}},[""!=e.row.cover?a("el-popover",{attrs:{trigger:"hover",placement:"right"}},[a("img",{attrs:{src:e.row.cover,align:"absmiddle",width:"200"}}),a("span",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.title))])]):t._e(),""==e.row.cover?a("span",[t._v(t._s(e.row.title))]):t._e(),t._v("\n               \n              "),1==e.row.best?a("el-tag",{attrs:{"disable-transitions":!0,type:"primary",size:"small"}},[t._v("推荐")]):t._e()],1)}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("作者: "+t._s(e.row.author))]),a("p",[t._v("日期: "+t._s(e.row.time))]),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[1==e.row.status?a("el-tag",{attrs:{"disable-transitions":t.bool,type:"success",size:"small"}},[t._v("已发布")]):t._e(),0==e.row.status?a("el-tag",{attrs:{"disable-transitions":t.bool,type:"danger",size:"small"}},[t._v("未发布")]):t._e()],1)])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1),t.items.data&&t.items.data.length>0?a("footer",[a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.batchDeleteData}},[t._v("批量删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("el-pagination",{attrs:{background:"","current-page":t.pagination.index,layout:"total, prev, pager, next,jumper",total:t.items.total,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1)],1)],1):t._e()],1)])],1)])},V=[],B=(a("ac6a"),a("f499")),L=a.n(B),A={name:"post",data:function(){return{bool:!0,loading:!1,first:!0,filter:{keyword:"",status:"",time:"",timeOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}},tags:[],items:[],pagination:{size:10,index:1},multipleSelection:[]}},mounted:function(){var t=this;this.$nextTick(function(){setTimeout(function(t){window.bus.$emit("nav","post")},100),window.localStorage.postIndex&&(t.pagination.index=window.localStorage.postIndex>>0),window.localStorage.postFilter&&(t.filter=JSON.parse(window.localStorage.postFilter)),t.getTags(),t.getData()})},methods:{getTags:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"tag",method:"data",data:'{"hot":1000}'},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,this.tags=i.result.hot,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),publish:function(){this.$router.push({path:"/post-form"})},filterSubmit:function(){window.localStorage.postFilter=L()(this.filter),window.localStorage.postIndex=this.pagination.index,this.getData()},filterReset:function(){window.localStorage.removeItem("postFilter"),window.localStorage.removeItem("postIndex"),this.filter.keyword="",this.filter.status="",this.filter.time="",this.filter.tag_id="",this.pagination.index=1,this.getData()},onPagination:function(t){window.localStorage.postIndex=t,this.pagination.index=t,this.getData()},onSelection:function(t){this.multipleSelection=t},batchDeleteData:function(){var t=this;if(0==this.multipleSelection.length)return this.$message.warning("至少选择一个"),!1;var e=this.multipleSelection.map(function(t){return t.id}).join(",");this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function a(){var i,s,n;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"post",method:"delete",ids:e},a.next=4,t.$http.get("/api.php",{params:i});case 4:return s=a.sent,a.prev=5,a.next=8,s.data;case 8:n=a.sent,200==n.code?(t.loading=!1,t.getData()):t.$message.error(n.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}},a,this,[[5,12]])})))},editData:function(t){this.$router.push({path:"/post-form",query:{id:t.id}})},deleteData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function t(){var i,s,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"post",method:"delete",ids:e.id},t.next=4,a.$http.get("/api.php",{params:i});case 4:return s=t.sent,t.prev=5,t.next=8,s.data;case 8:n=t.sent,200==n.code?(a.loading=!1,a.getData()):a.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"post",method:"search",page_index:this.pagination.index,page_size:this.pagination.size},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.time&&(e.begin=+new Date(this.filter.time[0])/1e3>>0,e.end=+new Date(this.filter.time[1])/1e3>>0),""!=this.filter.status&&(e.status=this.filter.status),""!=this.filter.tag_id&&(e.tag_id=this.filter.tag_id),t.next=8,this.$http.get("/api.php",{params:e});case 8:return a=t.sent,t.prev=9,t.next=12,a.data;case 12:i=t.sent,i.result.data.forEach(function(t){t.time=new Date(1e3*t.time).format("yyyy/mm/dd")}),this.items=i.result,this.loading=!1,this.first=!1,t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](9),this.$message.error("网络异常");case 22:case"end":return t.stop()}},t,this,[[9,19]])}));function e(){return t.apply(this,arguments)}return e}()}},H=A,G=(a("18de"),Object(m["a"])(H,q,V,!1,null,"bafe7ec4",null)),W=G.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("h1",[t._v(t._s(t.edit?"更新文章":"发布文章"))]),a("p",[t._v("文章支持上传图片，附件，关键字和描述是针对搜索引擎设置")])]),a("el-col",{attrs:{span:12,align:"right"}},[t.edit?t._e():a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.saveDraft()}}},[t._v("存草稿")]),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.submit()}}},[t._v(t._s(t.edit?"更新":"发布"))])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("正文")]),a("div",{staticClass:"box-content"},[a("el-form",{ref:"post",attrs:{model:t.post}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{placeholder:"标题（5-200字）",maxlength:"200",clearable:""},model:{value:t.post.title,callback:function(e){t.$set(t.post,"title",e)},expression:"post.title"}})],1),a("editor",{ref:"editor",model:{value:t.post.content,callback:function(e){t.$set(t.post,"content",e)},expression:"post.content"}})],1)],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.upload.file.loading,expression:"upload.file.loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("附件")]),a("div",{staticClass:"box-content"},[a("el-upload",{staticStyle:{float:"right"},attrs:{multiple:"",action:t.upload.file.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.file.success,"before-upload":t.upload.file.before,"on-progress":t.upload.file.progress}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("\n                上传\n                "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.post.files,stripe:"","show-overflow-tooltip":""}},[a("el-table-column",{attrs:{label:"文件"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{on:{click:function(a){return t.addFile(e.row)}}},[e.row.image?[a("img",{attrs:{src:e.row.url,height:"30",align:"absmiddle"}})]:[t._v(t._s(e.row.name))]],2)}}])}),a("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return["video/mp4"==e.row.type?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.addFile(e.row)}}},[t._v("插入")]):t._e(),e.row.image?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.previewFile(e.row.url)}}},[t._v("预览")]):t._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return t.deleteFile(e.$index)}}},[t._v("删除")])]}}])})],1),t._l(t.post.files,function(t,e){return a("el-row",{key:e},[a("el-col",{attrs:{span:12}}),a("el-col",{attrs:{span:12}})],1)})],2)]),a("div",{staticClass:"important warn"},[a("strong",[t._v("上传说明")]),a("br"),t._v("1.缩图上传会自动压缩到600x600。\n          "),a("br"),t._v("2.附件中上传的照片图片会按比例自动压缩到1200x1200的范围。\n          "),a("br"),t._v("3.如果安装了exif扩展可以解决iPhone拍出来的照片自动纠正方向。\n          "),a("br"),t._v("4.上传格式支持jpg/png/gif/pdf/mp4/mov/mp3/psd/json/svg/docx/pptx/xlsx/ppt/xls/doc/zip/rar。\n          "),a("br"),t._v("5.PHP的GD库需要2.1以上版本最佳。\n          "),a("br"),t._v("6.上传文件需要考虑到\n          "),a("b",[t._v("最大上传限制")]),t._v("\n          和\n          "),a("b",[t._v("最大POST提交限制")]),t._v("。\n          "),a("br"),t._v("7.上传环境需要确保服务器地址和后台域名一致（包含协议，如：https）。\n        ")])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("\n            封面\n            "),""!=t.post.cover?a("el-button",{staticStyle:{float:"right",cursor:"pointer"},attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.previewFile(t.post.cover)}}},[t._v("预览")]):t._e()],1),a("div",{staticClass:"box-content"},[a("el-upload",{staticClass:"cover",attrs:{action:t.upload.cover.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.cover.success,"before-upload":t.upload.cover.before}},[""!=t.post.cover?a("img",{attrs:{src:t.post.cover,width:"100%",align:"absmiddle"}}):t._e(),""==t.post.cover?a("div",{staticStyle:{display:"block"}},[t._v("上传本地图片")]):t._e()]),""!=t.post.cover?a("div",{staticClass:"delete",on:{click:function(e){return e.stopPropagation(),t.clearCover(e)}}}):t._e()],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("关联标签")]),a("div",{staticClass:"box-content"},t._l(t.tags,function(e,i){return a("el-button",{key:i,staticStyle:{margin:"0 5px 5px 0"},attrs:{type:e.type},on:{click:function(a){return t.setTag(e)}}},[t._v(t._s(e.name))])}),1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("作者")]),a("div",{staticClass:"box-content"},[a("el-input",{attrs:{placeholder:"10字内",maxlength:"10",clearable:""},model:{value:t.post.author,callback:function(e){t.$set(t.post,"author",e)},expression:"post.author"}})],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("关键字")]),a("div",{staticClass:"box-content"},[a("el-input",{attrs:{placeholder:"例如: GUM,PHP",maxlength:"80",clearable:""},model:{value:t.post.keywords,callback:function(e){t.$set(t.post,"keywords",e)},expression:"post.keywords"}})],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("描述")]),a("div",{staticClass:"box-content"},[a("el-input",{attrs:{placeholder:"用于文章摘要，SEO描述",maxlength:"200",type:"textarea",rows:5,clearable:""},model:{value:t.post.description,callback:function(e){t.$set(t.post,"description",e)},expression:"post.description"}})],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[t._v("属性")]),a("div",{staticClass:"box-content"},[a("el-checkbox",{attrs:{label:"推荐",name:"best"},model:{value:t.post.best,callback:function(e){t.$set(t.post,"best",e)},expression:"post.best"}}),a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:t.post.status,callback:function(e){t.$set(t.post,"status",e)},expression:"post.status"}})],1)])])],1)],1)])},Q=[],Z=a("cebc"),K=(a("7f7f"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tinymce-editor"},[a("editor",{attrs:{init:t.init,disabled:t.disabled},on:{onClick:t.onClick},model:{value:t.myValue,callback:function(e){t.myValue=e},expression:"myValue"}})],1)}),X=[],tt=(a("c5f6"),a("e562")),et=a.n(tt),at=a("9917"),it=(a("7913"),a("4ea8"),a("64d8"),a("07d7"),a("2fec"),a("4237"),a("3aea"),a("07d1"),a("84ec"),a("0a9d"),a("f557"),a("9434"),a("bc54"),a("2d33"),a("34de"),a("3154"),a("840a"),a("55a0"),a("c3d7"),{components:{Editor:at["a"]},props:{value:{type:String,default:""},disabled:{type:Boolean,default:!1},height:{type:Number,default:360},plugins:{type:[String,Array],default:"print tabfocus preview fullscreen autolink link charmap lists image code codesample media table colorpicker textcolor wordcount contextmenu media paste"},toolbar:{type:[String,Array],default:"formatselect bold italic underline strikethrough  forecolor backcolor | align bullist numlist outdent indent blockquote | link table image media | print  pastetext fullscreen code"}},data:function(){return{init:{convert_urls:!1,codesample_dialog_width:1e3,codesample_dialog_height:400,force_p_newlines:!1,language_url:"tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:"tinymce/skins/lightgray",height:this.height,plugins:this.plugins,toolbar1:" formatselect fontsizeselect link table image media pastetext code codesample fullscreen print charmap preview autolink colorpicker",toolbar2:" bold italic underline strikethrough  forecolor backcolor align bullist numlist outdent indent blockquote",branding:!1,menubar:!1,paste_data_images:!1},myValue:this.value}},mounted:function(){et.a.init({})},methods:{onClick:function(t){this.$emit("onClick",t,et.a)}},watch:{value:function(t){this.myValue=t},myValue:function(t){this.$emit("input",t)}}}),st=it,nt=Object(m["a"])(st,K,X,!1,null,null,null),rt=nt.exports,ot={components:{editor:rt},data:function(){var t=this;return{edit:!1,loading:!1,draftInterval:null,upload:{data:{token:localStorage.token},cover:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=post&original=600x600",before:function(e){var a="image/jpeg"===e.type,i=e.size/1024/1024<10;return a||t.$message.error("上传头像图片只能是 JPG 格式!"),i||t.$message.error("上传头像图片大小不能超过 10MB!"),a&&i},success:function(e){200==e.code?(t.post.cover=e.result.url,t.post.cover_id=e.result.id):t.$message.error(e.info)}},file:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=post&original=1200x1200",before:function(e){var a=e.size/1024/1024<50;return a||t.$message.error("上传大小不能超过 50MB!"),a},loading:!1,progress:function(e){var a=Math.floor(e.loaded/e.total*100);a<100&&(t.upload.file.loading=!0)},success:function(e){t.upload.file.loading=!1,200==e.code?t.post.files.push(e.result):t.$message.error(e.info)}}},tags:[],post:{title:"",content:"",author:"",cover:"",cover_id:"",file:"",keywords:"",description:"",best:!1,status:!0,tag_id:0,tag_name:"",files:[]}}},mounted:function(){var t=this;this.$nextTick(function(e){if(setTimeout(function(t){window.bus.$emit("nav","post")},100),t.$route.query.id)t.edit=!0,t.getData();else{var a=localStorage.draft;a&&(a=JSON.parse(a),t.post=a,t.$message.success("已从草稿中恢复")),t.getTags()}})},methods:{saveDraft:function(){""==this.post.title&&""==this.post.content||(window.localStorage.draft=L()(this.post),this.$message.success("草稿已保存"))},setContent:function(t){tinymce.activeEditor.execCommand("mceInsertContent",!1,t),this.post.content=et.a.activeEditor.getContent()},addFile:function(t){t.image?this.setContent('<img src="'.concat(t.url,'" style="max-width:100%">')):"video/mp4"==t.type?this.setContent('<video controls="controls" width="720" height="480"><source src="'.concat(t.url,'" type="video/mp4" /></video>')):this.setContent('<a href="'.concat(t.url,'">').concat(t.name,"</a>"))},setCover:function(t){this.post.cover=t.url,this.post.cover_id=t.id},clearCover:function(){this.post.cover="",this.post.cover_id=""},previewFile:function(t){window.open(t)},deleteFile:function(t){this.post.files.splice(t,1)},setTag:function(t){this.tags.forEach(function(t){return t.type=""}),t.type="primary",this.post.tag_id=t.id,this.post.tag_name=t.name},getTags:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={token:localStorage.token,class:"tag",method:"data",data:'{"hot":1000}'},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,s=[],i.result.hot.forEach(function(t){n.post.tag_id==t.id?(t.type="primary",n.post.tag_name=t.name):t.type="",s.push(t)}),this.tags=s,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),this.$message.error("网络异常");case 16:case"end":return t.stop()}},t,this,[[0,13]])}));function e(){return t.apply(this,arguments)}return e}(),getBindTags:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={token:localStorage.token,class:"tag",method:"data",data:'{"bind_id":'+this.$route.query.id+',"bind_type":"post"}'},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,s=[],i.result.bind.forEach(function(t){s.push(t)}),this.post.tags=s,this.$forceUpdate(),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),this.$message.error("网络异常");case 17:case"end":return t.stop()}},t,this,[[0,14]])}));function e(){return t.apply(this,arguments)}return e}(),getBindFiles:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={token:localStorage.token,class:"upload",method:"data",data:'{"bind_id":'+this.$route.query.id+',"bind_type":"post"}'},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.next=7,a.data;case 7:i=t.sent,200==i.code?(s=[],i.result.bind.forEach(function(t){t.id!=n.post.cover_id&&s.push(t)}),this.post.files=s,this.$forceUpdate()):this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[0,11]])}));function e(){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,e={token:localStorage.token,class:"post",method:"get",id:this.$route.query.id},t.next=5,this.$http.get("/api.php",{params:e});case 5:return a=t.sent,t.next=8,a.data;case 8:i=t.sent,200==i.code?(i.result.files=[],i.result.tags=[],i.result.best=1==i.result.best,i.result.status=1==i.result.status,this.post=i.result,this.loading=!1,this.getTags(),this.getBindFiles()):this.$message.error(i.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),this.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[1,12]])}));function e(){return t.apply(this,arguments)}return e}(),submit:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.post.title){t.next=3;break}return this.$message.error("标题不能为空"),t.abrupt("return");case 3:if(""!=this.post.content){t.next=6;break}return this.$message.error("内容不能为空"),t.abrupt("return");case 6:if(""!=this.post.tag_id){t.next=9;break}return this.$message.error("标签至少选择一个"),t.abrupt("return");case 9:return this.loading=!0,this.post.keywords=this.post.keywords.replace(/，/g,","),e=JSON.parse(L()(this.post)),e.file_ids=e.files.map(function(t){return t.id}).join(","),e.best=e.best?1:0,e.status=e.status?1:0,delete e.files,a=Object(Z["a"])({token:localStorage.token,class:"post",method:"save",id:this.$route.query.id},e),t.next=19,this.$http.post("/api.php",f.a.stringify(a));case 19:return i=t.sent,t.prev=20,t.next=23,i.data;case 23:s=t.sent,200==s.code?(localStorage.removeItem("draft"),this.loading=!1,this.$router.replace({path:"/post"})):this.$message.error(s.code),t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](20),this.$message.error("网络异常");case 30:case"end":return t.stop()}},t,this,[[20,27]])}));function e(){return t.apply(this,arguments)}return e}()}},lt=ot,ct=(a("e3ab"),Object(m["a"])(lt,Y,Q,!1,null,null,null)),ut=ct.exports,dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:10}},[a("h1",[t._v("会员")]),a("p",[t._v("会员包含基本会员和管理员")])]),a("el-col",{attrs:{span:14,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("添加")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header noborder"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"ID/邮箱/手机/昵称",maxlength:"10",clearable:""},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterSubmit()}},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","picker-options":t.filter.timeOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期",align:"center"},model:{value:t.filter.time,callback:function(e){t.$set(t.filter,"time",e)},expression:"filter.time"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.items.data,"tooltip-effect":"dark",stripe:""},on:{"selection-change":t.onSelection}},[a("el-table-column",{attrs:{type:"selection",selectable:t.canSelectable,width:"30"}}),a("el-table-column",{attrs:{prop:"address",label:"头像",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.photo?a("img",{staticClass:"photo",attrs:{src:e.row.photo,width:"50",height:"50"}}):t._e(),""==e.row.photo?a("div",{staticClass:"photo"},[t._v(t._s(e.row.nickname.substr(0,1)))]):t._e()]}}])}),a("el-table-column",{attrs:{label:"账号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.account)+" ("+t._s(e.row.nickname)+")\n              "),255==e.row.level?a("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("管理员")]):t._e(),e.row.email?[a("br"),t._v("\n                邮箱："+t._s(e.row.email)+"\n                "),e.row.email_verification?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}):t._e()]:t._e(),e.row.tel?[a("br"),t._v("\n                手机："+t._s(e.row.tel)+"\n                "),e.row.tel_verification?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}):t._e()]:t._e()]}}])}),a("el-table-column",{attrs:{prop:"address",label:"登陆",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.login_time)+"\n              "),a("br"),a("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("\n                "+t._s(e.row.login_ip)+"\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"address",label:"注册",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.join_time)+"\n              "),a("br"),a("el-tag",{attrs:{type:"warning",size:"mini"}},[t._v("\n                "+t._s(e.row.join_ip)+"\n              ")])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{type:"success",size:"small"}},[t._v("启用")]):t._e(),0==e.row.status?a("el-tag",{attrs:{type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),e.row.id!=t.id?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row.id)}}},[t._v("删除")]):t._e()]}}])})],1),t.items.data&&t.items.data.length>0&&t.items.total>t.pagination.size?a("footer",[a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:t.batchDeleteData}},[t._v("批量删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("el-pagination",{attrs:{background:"","current-page":t.pagination.index,layout:"total, prev, pager, next,jumper",total:t.items.count,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1)],1)],1):t._e()],1)])],1),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"800px"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{ref:"post",attrs:{model:t.dialog.fields}},[a("el-row",{attrs:{gutter:20,type:"flex"}},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"form-photo",style:{"background-image":"url("+this.dialog.fields.photo+")"}},[a("el-upload",{staticClass:"el-upload",attrs:{action:t.upload.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.success,"before-upload":t.upload.before}},[""==t.dialog.fields.photo?a("div",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):t._e()]),""!=t.dialog.fields.photo?a("div",{staticClass:"delete",on:{click:function(e){e.stopPropagation(),t.dialog.fields.photo=""}}}):t._e()],1)]),a("el-col",{attrs:{span:20}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{placeholder:"账号（3-20个由英文字母开头的字母）",maxlength:"20",disabled:t.dialog.edit,readonly:t.dialog.edit,clearable:""},model:{value:t.dialog.fields.account,callback:function(e){t.$set(t.dialog.fields,"account",e)},expression:"dialog.fields.account"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"password"}},[t.dialog.edit?t._e():a("el-input",{attrs:{placeholder:"密码（5-20个字符）",type:"password",maxlength:"20","show-password":"",clearable:""},model:{value:t.dialog.fields.password,callback:function(e){t.$set(t.dialog.fields,"password",e)},expression:"dialog.fields.password"}}),t.dialog.edit?a("el-input",{attrs:{placeholder:"密码（不修改请留空，5-20个字符）",type:"password",maxlength:"20","show-password":"",clearable:""},model:{value:t.dialog.fields.password,callback:function(e){t.$set(t.dialog.fields,"password",e)},expression:"dialog.fields.password"}}):t._e()],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"nickname"}},[a("el-input",{attrs:{placeholder:"昵称（3-10个字）",maxlength:"10",clearable:""},model:{value:t.dialog.fields.nickname,callback:function(e){t.$set(t.dialog.fields,"nickname",e)},expression:"dialog.fields.nickname"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{placeholder:"邮箱地址",maxlength:"100",clearable:""},model:{value:t.dialog.fields.email,callback:function(e){t.$set(t.dialog.fields,"email",e)},expression:"dialog.fields.email"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"tel"}},[a("el-input",{attrs:{placeholder:"手机号码",maxlength:"20",clearable:""},model:{value:t.dialog.fields.tel,callback:function(e){t.$set(t.dialog.fields,"tel",e)},expression:"dialog.fields.tel"}})],1)],1)],1)],1)],1),!t.dialog.edit&&t.dialog.fields.admin?a("el-form-item",{attrs:{prop:"permission"}},t._l(t.dialog.permissions,function(e){return a("span",{key:e.key,staticClass:"permission",class:{active:e.selected},on:{click:function(a){return t.selectedPermission(e)}}},[t._v(t._s(e.name))])}),0):t._e(),t.dialog.edit&&t.dialog.fields.id!=t.id&&t.dialog.fields.admin?a("el-form-item",{attrs:{prop:"permission"}},t._l(t.dialog.permissions,function(e){return a("span",{key:e.key,staticClass:"permission",class:{active:e.selected},on:{click:function(a){return t.selectedPermission(e)}}},[t._v(t._s(e.name))])}),0):t._e()],1),a("el-row",[a("el-col",{staticStyle:{"padding-top":"10px","text-align":"left"},attrs:{span:14}},[a("el-checkbox",{attrs:{label:"启用",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}}),a("el-checkbox",{attrs:{label:"手机验证",name:"tel_verification"},model:{value:t.dialog.fields.tel_verification,callback:function(e){t.$set(t.dialog.fields,"tel_verification",e)},expression:"dialog.fields.tel_verification"}}),a("el-checkbox",{attrs:{label:"邮件验证",name:"email_verification"},model:{value:t.dialog.fields.email_verification,callback:function(e){t.$set(t.dialog.fields,"email_verification",e)},expression:"dialog.fields.email_verification"}}),t.dialog.fields.id!=t.id?a("el-checkbox",{attrs:{label:"管理员",name:"level"},model:{value:t.dialog.fields.admin,callback:function(e){t.$set(t.dialog.fields,"admin",e)},expression:"dialog.fields.admin"}}):t._e()],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:10}},[a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("确 定")])],1)],1)],1)],1)},pt=[],ft=(a("28a5"),{name:"user",data:function(){var t=this;return{id:null,loading:!1,first:!0,filter:{keyword:"",status:"",time:"",timeOptions:{shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]}},upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=user&original=200x200",data:{token:localStorage.token},before:function(e){var a="image/jpeg"===e.type,i=e.size/1024/1024<5;return a||t.$message.error("上传头像图片只能是 JPG 格式!"),i||t.$message.error("上传头像图片大小不能超过 2MB!"),a&&i},success:function(e){200==e.code?(t.dialog.fields.photo=e.result.url,t.dialog.fields.photo_id=e.result.id):t.$message.error(e.info)}},dialog:{title:"新增",show:!1,edit:!1,permissions:d,fields:{photo:"",photo_id:"",account:"",password:"",level:"0",nickname:"",email:"",email_verification:!1,tel:"",tel_verification:!1,status:!0}},items:[],pagination:{size:10,index:1},multipleSelection:[]}},mounted:function(){this.id=window.localStorage.id,setTimeout(function(t){window.bus.$emit("nav","user")},100),this.getData()},methods:{canSelectable:function(t){return t.id!=this.id},filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.filter.time="",this.pagination.index=1,this.getData()},onPagination:function(t){this.pagination.index=t,this.getData()},onSelection:function(t){this.multipleSelection=t},batchDeleteData:function(){var t=this;if(0==this.multipleSelection.length)return this.$message.warning("至少选择一个"),!1;var e=this.multipleSelection.map(function(t){return t.id}).join(",");this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function a(){var i,s,n;return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"user",method:"delete",ids:e},a.next=4,t.$http.get("/api.php",{params:i});case 4:return s=a.sent,a.prev=5,a.next=8,s.data;case 8:n=a.sent,200==n.code?(t.loading=!1,t.getData()):t.$message.error(n.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}},a,this,[[5,12]])})))},addData:function(){this.dialog.show=!0,this.dialog.edit=!1,this.dialog.title="创建会员",this.dialog.fields={photo:"",photo_id:"",account:"",password:"",level:"0",nickname:"",email:"",email_verification:!1,tel:"",tel_verification:!1,status:!0},this.dialog.permissions.forEach(function(t){return t.selected=!0})},editData:function(t){t.status=1==t.status,this.dialog.show=!0,this.dialog.edit=!0,this.dialog.title="编辑会员",this.dialog.fields=t,"super"!=t.permission?this.dialog.permissions.forEach(function(e){return e.selected=t.permission&&t.permission.split(",").includes(e.key)}):this.dialog.permissions.forEach(function(t){return t.selected=!0})},deleteData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function t(){var i,s,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"user",method:"delete",ids:e},t.next=4,a.$http.get("/api.php",{params:i});case 4:return s=t.sent,t.prev=5,t.next=8,s.data;case 8:n=t.sent,200==n.code?(a.loading=!1,a.getData()):a.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"user",method:"search",page_index:this.pagination.index,page_size:this.pagination.size},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.time&&(e.begin=+new Date(this.filter.time[0])/1e3>>0,e.end=+new Date(this.filter.time[1])/1e3>>0),""!=this.filter.status&&(e.status=this.filter.status),t.next=7,this.$http.get("/api.php",{params:e});case 7:return a=t.sent,t.prev=8,t.next=11,a.data;case 11:i=t.sent,200==i.code?(i.result.data.forEach(function(t){t.tel_verification=1==t.tel_verification,t.email_verification=1==t.email_verification,t.admin=255==t.level,t.join_time=new Date(1e3*t.join_time).format("yyyy/mm/dd h:i"),t.login_time=new Date(1e3*t.login_time).format("yyyy/mm/dd h:i")}),this.items=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](8),this.$message.error("网络异常");case 18:case"end":return t.stop()}},t,this,[[8,15]])}));function e(){return t.apply(this,arguments)}return e}(),saveData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.fields.account){t.next=3;break}return this.$message.error("账号不能为空"),t.abrupt("return");case 3:if(""!=this.dialog.fields.nickname){t.next=6;break}return this.$message.error("昵称不能为空"),t.abrupt("return");case 6:if(this.dialog.edit||""!=this.dialog.fields.password){t.next=9;break}return this.$message.error("密码不能为空"),t.abrupt("return");case 9:if(this.dialog.edit||!(this.dialog.fields.password.length<5)){t.next=12;break}return this.$message.error("密码不能小于5位"),t.abrupt("return");case 12:return e=JSON.parse(L()(this.dialog.fields)),e.email_verification=e.email_verification?1:0,e.tel_verification=e.tel_verification?1:0,e.level=e.admin?255:0,e.status=e.status?1:0,0==this.dialog.permissions.filter(function(t){return 0==t.selected}).length?e.permission="super":e.permission=this.dialog.permissions.filter(function(t){return t.selected}).map(function(t){return t.key}).join(","),a=Object(Z["a"])({token:localStorage.token,class:"user",method:"save",id:this.$route.query.id},e),t.next=21,this.$http.post("/api.php",f.a.stringify(a));case 21:return i=t.sent,t.prev=22,t.next=25,i.data;case 25:s=t.sent,200==s.code?(this.dialog.show=!1,this.pagination.index=1,this.getData()):this.$message.error(s.code),t.next=32;break;case 29:t.prev=29,t.t0=t["catch"](22),this.$message.error("网络异常");case 32:case"end":return t.stop()}},t,this,[[22,29]])}));function e(){return t.apply(this,arguments)}return e}(),selectedPermission:function(t){t.selected?t.selected=!1:t.selected=!0,this.$forceUpdate()}}}),ht=ft,gt=(a("291a"),Object(m["a"])(ht,dt,pt,!1,null,"3815c884",null)),mt=gt.exports,vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("h1",[t._v("标签")]),a("p",[t._v("标签中的标签字段是用于二次开发时候使用的，比如在首页有些标签需要显示图片列表可以用标签字段值进行区别显示。")])]),a("el-col",{attrs:{span:12,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("添加")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header noborder"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"关键字"},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",{staticStyle:{"margin-bottom":"2px"}},[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:t.result.data,"tooltip-effect":"dark"},on:{"selection-change":t.onSelection}},[a("el-table-column",{attrs:{align:"center",label:"编号",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.id))]}}])}),a("el-table-column",{attrs:{label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),a("el-table-column",{attrs:{align:"center",label:"标签",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.tag))]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"success",size:"small"}},[t._v("启用")]):t._e(),0==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success",size:"mini",disabled:0==e.$index},on:{click:function(a){return t.moveUp(e.$index)}}},[t._v("上移")]),a("el-button",{attrs:{type:"success",size:"mini",disabled:e.$index==t.result.data.length-1},on:{click:function(a){return t.moveDown(e.$index)}}},[t._v("下移")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1),t.result.data&&t.result.data.length>0&&t.result.total>t.pagination.size?a("footer",[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:t.result.total,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1):t._e()],1)])],1),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"30%"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{placeholder:"名称"},model:{value:t.dialog.fields.name,callback:function(e){t.$set(t.dialog.fields,"name",e)},expression:"dialog.fields.name"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"标签（可选）"},model:{value:t.dialog.fields.tag,callback:function(e){t.$set(t.dialog.fields,"tag",e)},expression:"dialog.fields.tag"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"启用",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}}),t._v(" \n      "),a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("确 定")])],1)],1)],1)},bt=[],wt={data:function(){return{loading:!1,first:!0,filter:{keyword:"",status:""},dialog:{title:"修改",show:!1,fields:{name:"",tag:"",status:!0}},result:{},pagination:{size:1e5,index:1},multipleSelection:[]}},mounted:function(){setTimeout(function(t){window.bus.$emit("nav","tag")},100),this.getData()},methods:{filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.filter.time="",this.pagination.index=1,this.getData()},onPagination:function(t){this.pagination.current=t,this.getData()},onSelection:function(t){this.multipleSelection=t},onSelectionToggle:function(){this.$refs.table.toggleAllSelection()},addData:function(){this.dialog={title:"新增",show:!0,fields:{name:"",tag:"",status:!0}}},editData:function(t){var e=JSON.parse(L()(t));e.status=1==e.status,this.dialog={title:"编辑",show:!0,fields:e}},deleteData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function t(){var i,s,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"tag",method:"delete",id:e.id},t.next=4,a.$http.get("/api.php",{params:i});case 4:return s=t.sent,t.prev=5,t.next=8,s.data;case 8:n=t.sent,200==n.code?(a.loading=!1,a.getData()):a.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"tag",method:"search",page_index:this.pagination.index,page_size:this.pagination.size},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.status&&(e.status=this.filter.status),t.next=6,this.$http.get("/api.php",{params:e});case 6:return a=t.sent,t.prev=7,t.next=10,a.data;case 10:i=t.sent,200==i.code?(this.result=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),this.$message.error("网络异常");case 17:case"end":return t.stop()}},t,this,[[7,14]])}));function e(){return t.apply(this,arguments)}return e}(),saveData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.name){t.next=3;break}return this.$message.error("标签不能为空"),t.abrupt("return");case 3:return this.loading=!0,e=JSON.parse(L()(this.dialog.fields)),e.status=e.status?1:0,a=Object(Z["a"])({token:localStorage.token,class:"tag",method:"save"},e),t.next=9,this.$http.get("/api.php",{params:a});case 9:return i=t.sent,t.prev=10,t.next=13,i.data;case 13:s=t.sent,200==s.code?(this.loading=!1,this.dialog.show=!1,this.getData()):this.$message.error(s.code),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](10),this.$message.error("网络异常");case 20:case"end":return t.stop()}},t,this,[[10,17]])}));function e(){return t.apply(this,arguments)}return e}(),swap:function(t,e,a){return t[a]=t.splice(e,1,t[a])[0],t},moveUp:function(t){0!=t&&(this.swap(this.result.data,t,t-1),this.updateSort())},moveDown:function(t){t!=this.result.data.length-1&&(this.swap(this.result.data,t,t+1),this.updateSort())},updateSort:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"tag",method:"update_sort",ids:this.result.data.map(function(t){return t.id}).join(",")},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code||this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}()}},kt=wt,_t=(a("b21a"),Object(m["a"])(kt,vt,bt,!1,null,"2314b7b4",null)),yt=_t.exports,xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("h1",[t._v("链接")]),a("p",[t._v("链接标签是用于二次开发模板的时候用的，可以做轮换图片模块等。")])]),a("el-col",{attrs:{span:12,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("添加")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header noborder"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:t.filter}},[a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"关键字(标题/网址/标签)"},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterSubmit()}},model:{value:t.filter.keyword,callback:function(e){t.$set(t.filter,"keyword",e)},expression:"filter.keyword"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterSubmit()}}},[t._v("搜索")])],1),a("el-form-item",{staticStyle:{"margin-bottom":"3px"}},[a("el-button",{attrs:{type:"normal"},on:{click:function(e){return t.filterReset()}}},[t._v("重置")])],1)],1)],1)]),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.result.data}},[a("el-table-column",{attrs:{label:"图片",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.image?a("div",{staticClass:"empty",style:{"background-image":"url("+e.row.image+")"},on:{click:function(a){return t.open(e.row.image)}}}):t._e(),""==e.row.image?a("div",{staticClass:"empty"},[t._v("?")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b",[t._v(t._s(e.row.title))]),a("br"),a("el-link",{attrs:{type:"success",target:"_blank",href:e.row.url}},[t._v(t._s(e.row.url))])]}}])}),a("el-table-column",{attrs:{label:"标签",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("b",[t._v(t._s(e.row.tag))])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"success",size:"small"}},[t._v("启用")]):t._e(),0==e.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{disabled:0==e.$index,type:"success",size:"mini"},on:{click:function(a){return t.moveUp(e.$index)}}},[t._v("上移")]),a("el-button",{attrs:{disabled:e.$index==t.result.data.length-1,type:"success",size:"mini"},on:{click:function(a){return t.moveDown(e.$index)}}},[t._v("下移")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1),t.result.data&&t.result.data.length>0&&t.result.total>t.pagination.size?a("footer",{staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:t.result.total,"page-size":t.pagination.size},on:{"current-change":t.onPagination}})],1):t._e()],1)])],1),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"40%"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"image",style:{"background-image":"url("+this.dialog.fields.image+")"}},[a("el-upload",{staticClass:"el-upload",attrs:{action:t.upload.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.success,"before-upload":t.upload.before}},[a("div",{staticClass:"placeholder"},[""==t.dialog.fields.image?[t._v("图片(可选)")]:t._e()],2)]),""!=t.dialog.fields.image?a("div",{staticClass:"delete",on:{click:function(e){e.stopPropagation(),t.dialog.fields.image=""}}}):t._e()],1)]),a("el-col",{attrs:{span:18}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"标题"},model:{value:t.dialog.fields.title,callback:function(e){t.$set(t.dialog.fields,"title",e)},expression:"dialog.fields.title"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"网址"},model:{value:t.dialog.fields.url,callback:function(e){t.$set(t.dialog.fields,"url",e)},expression:"dialog.fields.url"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"标签（可选）",maxlength:"10"},model:{value:t.dialog.fields.tag,callback:function(e){t.$set(t.dialog.fields,"tag",e)},expression:"dialog.fields.tag"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}}),t._v(" \n      "),a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveData()}}},[t._v("确 定")])],1)],1)],1)},$t=[],St={data:function(){var t=this;return{loading:!1,first:!0,upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=link",data:{token:localStorage.token},before:function(e){var a="image/jpeg"===e.type||"image/png"===e.type||"image/svg+xml"===e.type||"image/gif"===e.type,i=e.size/1024/1024<1;return a||t.$message.error("上传图片格式错误!"),i||t.$message.error("上传图片大小不能超过 1MB!"),a&&i},success:function(e){200==e.code?(t.dialog.fields.image_id=e.result.id,t.dialog.fields.image=e.result.url):t.$message.error(e.info)}},filter:{keyword:"",status:""},dialog:{title:"新增",show:!1,fields:{image:"",image_id:"",title:"",url:"",tag:"",status:!0}},result:{},pagination:{size:1e5,index:1}}},computed:{},mounted:function(){setTimeout(function(){window.bus.$emit("nav","link")},100),this.getData()},methods:{open:function(t){window.open(t)},filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.pagination.index=1,this.getData()},onPagination:function(t){this.pagination.index=t,this.getData()},getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"link",method:"search",page_size:this.pagination.size,page_index:this.pagination.index},""!=this.filter.keyword&&(e.keyword=this.filter.keyword),""!=this.filter.status&&(e.status=this.filter.status),t.next=6,this.$http.get("/api.php",{params:e});case 6:return a=t.sent,t.prev=7,t.next=10,a.data;case 10:i=t.sent,200==i.code?(i.result.data.forEach(function(t){t.status=1==t.status}),this.result=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),this.$message.error("网络异常");case 17:case"end":return t.stop()}},t,this,[[7,14]])}));function e(){return t.apply(this,arguments)}return e}(),addData:function(){this.dialog={title:"添加",show:!0,fields:{image:"",image_id:"",title:"",url:"",tag:"",status:!0}}},editData:function(t){var e=JSON.parse(L()(t));e.status=1==e.status,this.dialog={title:"编辑",show:!0,fields:Object(Z["a"])({},e)}},deleteData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function t(){var i,s,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"link",method:"delete",id:e.id},t.next=4,a.$http.get("/api.php",{params:i});case 4:return s=t.sent,t.prev=5,t.next=8,s.data;case 8:n=t.sent,200==n.code?(a.loading=!1,a.getData()):a.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),saveData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.fields.title){t.next=3;break}return this.$message.error("标题不能为空"),t.abrupt("return");case 3:if(""!=this.dialog.fields.url){t.next=6;break}return this.$message.error("网址不能为空"),t.abrupt("return");case 6:return this.loading=!0,e=JSON.parse(L()(this.dialog.fields)),e.status=e.status?1:0,a=Object(Z["a"])({token:localStorage.token,class:"link",method:"save"},e),t.next=12,this.$http.get("/api.php",{params:a});case 12:return i=t.sent,t.prev=13,t.next=16,i.data;case 16:s=t.sent,200==s.code?(this.loading=!1,this.dialog.show=!1,this.getData()):this.$message.error(s.code),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](13),this.$message.error("网络异常");case 23:case"end":return t.stop()}},t,this,[[13,20]])}));function e(){return t.apply(this,arguments)}return e}(),swap:function(t,e,a){return t[a]=t.splice(e,1,t[a])[0],t},moveUp:function(t){0!=t&&(this.swap(this.result.data,t,t-1),this.updateSort())},moveDown:function(t){t!=this.result.data.length-1&&(this.swap(this.result.data,t,t+1),this.updateSort())},updateSort:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"link",method:"update_sort",ids:this.result.data.map(function(t){return t.id}).join(",")},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code||this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}()}},Ct=St,Dt=(a("7258"),Object(m["a"])(Ct,xt,$t,!1,null,"5eb846e5",null)),Ot=Dt.exports,jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:10}},[a("h1",[t._v("数据备份/还原")]),a("p",[t._v("还原数据库会覆盖现有的数据库，请谨慎操作，备份文件保存在 backup 文件夹中。")])]),a("el-col",{attrs:{span:14,align:"right"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.backup()}}},[t._v("立即备份")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.items}},[a("el-table-column",{attrs:{label:"时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.time))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"success"},on:{click:function(a){return t.restore(e.row.name)}}},[t._v("立即还原")])]}}])})],1)],1)])],1)])},Rt=[],zt={name:"backup",data:function(){return{loading:!1,first:!0,items:[]}},computed:{},mounted:function(){setTimeout(function(t){window.bus.$emit("nav","backup")},100),this.getData()},methods:{getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"backup",method:"search"},t.next=4,this.$http.get("/api.php",{params:e});case 4:return a=t.sent,t.prev=5,t.next=8,a.data;case 8:i=t.sent,200==i.code?(this.items=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),this.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[5,12]])}));function e(){return t.apply(this,arguments)}return e}(),backup:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={token:localStorage.token,class:"backup",method:"backup"},t.next=3,this.$http.get("/api.php",{params:e});case 3:return a=t.sent,t.prev=4,t.next=7,a.data;case 7:i=t.sent,200==i.code?(this.getData(),this.$message.success("备份成功")):this.$message.error(i.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),this.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])}));function e(){return t.apply(this,arguments)}return e}(),restore:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确定要还原数据库吗？还原后现有的数据库将会被覆盖！").then(Object(u["a"])(regeneratorRuntime.mark(function t(){var i,s,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i={token:localStorage.token,class:"backup",method:"restore",file:e},t.next=3,a.$http.get("/api.php",{params:i});case 3:return s=t.sent,t.prev=4,t.next=7,s.data;case 7:n=t.sent,200==n.code?(a.getData(),a.$message.success("还原成功")):a.$message.error("还原失败"),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),a.$message.error("网络异常");case 14:case"end":return t.stop()}},t,this,[[4,11]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},Pt=zt,Et=Object(m["a"])(Pt,jt,Rt,!1,null,null,null),Tt=Et.exports,Nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.first?a("div",{staticClass:"layout"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.first,expression:"first"}],staticClass:"box",staticStyle:{height:"500px"}})]):t._e(),t.first?t._e():a("div",{staticClass:"layout"},[a("el-row",{staticClass:"layout-header",attrs:{type:"flex",align:"middle",justify:"end"}},[a("el-col",{attrs:{span:12}},[a("h1",[t._v("设置")]),a("p",[t._v("管理系统所有的全局变量，均可在页面中自由调用。")])]),a("el-col",{attrs:{span:12,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addData()}}},[t._v("添加")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{attrs:{data:t.items}},[a("el-table-column",{attrs:{label:"描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.description)+" ("+t._s(e.row.key)+")")]}}])}),a("el-table-column",{attrs:{label:"类型",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.type?a("el-tag",{attrs:{size:"small"}},[t._v("纯文本")]):t._e(),1==e.row.type?a("el-tag",{attrs:{size:"small"}},[t._v("富文本")]):t._e(),2==e.row.type?a("el-tag",{attrs:{size:"small"}},[t._v("文件")]):t._e(),3==e.row.type?a("el-tag",{attrs:{size:"small"}},[t._v("开关")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("el-tag",{attrs:{type:"success",size:"small"}},[t._v("正常")]):t._e(),0==e.row.status?a("el-tag",{attrs:{type:"danger",size:"small"}},[t._v("禁用")]):t._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.editData(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1)],1)])],1),a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,width:"650px"},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{attrs:{"label-width":"80px","label-position":"top"}},[a("el-form-item",{attrs:{label:"变量"}},[a("el-input",{attrs:{placeholder:"只允许大小写字母、数字、-_.等字符"},model:{value:t.dialog.fields.key,callback:function(e){t.$set(t.dialog.fields,"key",e)},expression:"dialog.fields.key"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"这个变量是用来做什么的？"},model:{value:t.dialog.fields.description,callback:function(e){t.$set(t.dialog.fields,"description",e)},expression:"dialog.fields.description"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio",{attrs:{label:0,disabled:t.edit},nativeOn:{click:function(e){return t.selectOption("")}},model:{value:t.dialog.fields.type,callback:function(e){t.$set(t.dialog.fields,"type",e)},expression:"dialog.fields.type"}},[t._v("纯文本")]),a("el-radio",{attrs:{label:1,disabled:t.edit},nativeOn:{click:function(e){return t.selectOption("")}},model:{value:t.dialog.fields.type,callback:function(e){t.$set(t.dialog.fields,"type",e)},expression:"dialog.fields.type"}},[t._v("富文本")]),a("el-radio",{attrs:{label:2,disabled:t.edit},nativeOn:{click:function(e){return t.selectOption("")}},model:{value:t.dialog.fields.type,callback:function(e){t.$set(t.dialog.fields,"type",e)},expression:"dialog.fields.type"}},[t._v("上传文件")]),a("el-radio",{attrs:{label:3,disabled:t.edit},nativeOn:{click:function(e){return t.selectOption("off")}},model:{value:t.dialog.fields.type,callback:function(e){t.$set(t.dialog.fields,"type",e)},expression:"dialog.fields.type"}},[t._v("开关")])],1),a("el-form-item",{attrs:{label:"内容"}},[0==t.dialog.fields.type?[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:t.dialog.fields.value,callback:function(e){t.$set(t.dialog.fields,"value",e)},expression:"dialog.fields.value"}})]:t._e(),1==t.dialog.fields.type?[a("editor",{ref:"editor",attrs:{height:150},model:{value:t.dialog.fields.value,callback:function(e){t.$set(t.dialog.fields,"value",e)},expression:"dialog.fields.value"}}),a("br")]:t._e(),2==t.dialog.fields.type?[t.uploadIsImage?a("img",{attrs:{src:t.dialog.fields.value,width:"100%"}}):t.uploadIsVideo?a("video",{attrs:{controls:"controls",src:t.dialog.fields.value,width:"100%",height:"auto"}}):a("a",{attrs:{href:t.dialog.fields.value,target:"_blank"},domProps:{textContent:t._s(t.dialog.fields.value)}})]:t._e(),3==t.dialog.fields.type?[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off","active-text":"on","inactive-text":"off"},model:{value:t.dialog.switch,callback:function(e){t.$set(t.dialog,"switch",e)},expression:"dialog.switch"}})]:t._e(),1==t.dialog.fields.type||2==t.dialog.fields.type?a("el-upload",{attrs:{action:t.upload.action,data:t.upload.data,"show-file-list":!1,"on-success":t.upload.success,"before-upload":t.upload.before,"on-progress":t.upload.progress}},[a("el-button",{attrs:{type:"primary"}},[t._v("\n            上传文件\n            "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1):t._e()],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:t.dialog.fields.status,callback:function(e){t.$set(t.dialog.fields,"status",e)},expression:"dialog.fields.status"}}),t._v(" \n      "),a("el-button",{on:{click:function(e){t.dialog.show=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.save()}}},[t._v("确 定")])],1)],1)],1)},It=[],Mt=a("5176"),Ft=a.n(Mt),Ut={name:"config",components:{editor:rt},watch:{"dialog.switch":function(t){3==this.dialog.fields.type&&(this.dialog.fields.value=t?"on":"off")}},data:function(){var t=this;return{loading:!1,first:!0,edit:!1,files:[],upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=config",data:{token:localStorage.token},before:function(e){var a=e.size/1024/1024<50;return a||t.$message.error("上传大小不能超过 50MB!"),a},loading:!1,progress:function(e){var a=Math.floor(e.loaded/e.total*100);a<100&&(t.upload.loading=!0)},success:function(e){200==e.code?t.addFile(e.result):t.$message.error(e.info)}},file:[],dialog:{title:"添加",show:!1,switch:!1,fields:{ids:[],key:"",value:"",description:"",status:!0,type:0}},items:[]}},computed:{uploadIsImage:function(){if(0==this.dialog.fields.type||""==this.dialog.fields.value)return!1;var t=this.dialog.fields.value.substring(this.dialog.fields.value.lastIndexOf(".")+1);return"jpg"==t||"gif"==t||"png"==t},uploadIsVideo:function(){if(0==this.dialog.fields.type||""==this.dialog.fields.value)return!1;var t=this.dialog.fields.value.substring(this.dialog.fields.value.lastIndexOf(".")+1);return"mp4"==t}},mounted:function(){setTimeout(function(t){window.bus.$emit("nav","config")},100),this.getData()},methods:{selectOption:function(t){this.edit||(this.dialog.fields.value=t)},setContent:function(t){var e=et.a.activeEditor.getContent();et.a.activeEditor.setContent(e+t)},addFile:function(t){0==this.dialog.fields.type?t.image?this.setContent('<img src="'.concat(t.url,'" style="max-width:100%">')):"video/mp4"==t.type?this.setContent('<video controls="controls" width="720" height="480"><source src="'.concat(t.url,'" type="video/mp4" /></video>')):this.setContent('<a href="'.concat(t.url,'">').concat(t.name,"</a>")):this.dialog.fields.value=t.url,this.dialog.fields.ids.push(t.id)},getData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={token:localStorage.token,class:"config",method:"gets"},t.prev=2,t.next=5,this.$http.get("/api.php",{params:e});case 5:return a=t.sent,t.next=8,a.data;case 8:i=t.sent,200==i.code?(i.result.forEach(function(t){t.status=1==t.status}),this.items=i.result,this.loading=!1,this.first=!1):this.$message.error(i.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),this.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[2,12]])}));function e(){return t.apply(this,arguments)}return e}(),addData:function(){this.edit=!1,this.dialog={title:"添加设置",show:!0,fields:{ids:[],key:"",value:"",description:"",status:!0,type:0}}},editData:function(t){this.dialog.title="修改设置",this.dialog.show=!0,this.dialog.fields=Ft()(this.dialog.fields,t),this.edit=!0},deleteData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var a=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.$confirm("确认要删除吗").then(Object(u["a"])(regeneratorRuntime.mark(function t(){var i,s,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,i={token:localStorage.token,class:"config",method:"delete",key:e.key},t.prev=2,t.next=5,a.$http.get("/api.php",{params:i});case 5:return s=t.sent,t.next=8,s.data;case 8:n=t.sent,200==n.code?(a.loading=!1,a.getData()):a.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),a.$message.error("网络异常");case 15:case"end":return t.stop()}},t,this,[[2,12]])})));case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),deleteFile:function(t){this.files.splice(t,1)},save:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.dialog.fields.key){t.next=3;break}return this.$message.warning("数据未填写完整"),t.abrupt("return");case 3:if(/^[a-zA-Z0-9-_\.]*$/.test(this.dialog.fields.key)){t.next=6;break}return this.$message.warning("变量只允许大小写字母数字和“-”，“_”，“.”字符串"),t.abrupt("return");case 6:return this.loading=!0,e={token:localStorage.token,class:"config",method:"save",ids:this.dialog.fields.ids.join(","),key:this.dialog.fields.key,value:this.dialog.fields.value,description:this.dialog.fields.description,status:this.dialog.fields.status?1:0,type:this.dialog.fields.type},t.prev=8,t.next=11,this.$http.post("/api.php",f.a.stringify(e));case 11:return a=t.sent,t.next=14,a.data;case 14:i=t.sent,200==i.code?(this.loading=!1,this.dialog.show=!1,this.getData()):this.$message.error(i.code),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](8),this.$message.error("网络异常");case 21:case"end":return t.stop()}},t,this,[[8,18]])}));function e(){return t.apply(this,arguments)}return e}()}},Jt=Ut,qt=(a("bfc9"),Object(m["a"])(Jt,Nt,It,!1,null,"2447e88f",null)),Vt=qt.exports;n["default"].use(x["a"]);var Bt=new x["a"]({routes:[{path:"*",component:J},{path:"/",component:N},{path:"/dashboard",component:j},{path:"/post",component:W},{path:"/post-form",component:ut},{path:"/user",component:mt},{path:"/tag",component:yt},{path:"/link",component:Ot},{path:"/backup",component:Tt},{path:"/config",component:Vt}]}),Lt=a("5c96"),At=a.n(Lt),Ht=(a("0fae"),a("fe3c")),Gt=a.n(Ht),Wt=a("bc3a"),Yt=a.n(Wt);n["default"].use(At.a),Gt.a.prototype.focus=function(t){var e;/ios/g.test(window.navigator.userAgent.toLowerCase())&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type?(e=t.value.length,t.focus(),t.setSelectionRange(e,e)):t.focus()},window.localStorage.server&&(Yt.a.defaults.baseURL=window.localStorage.server),Yt.a.defaults.timeout=6e4,Yt.a.defaults.headers["Content-Type"]="application/x-www-form-urlencoded",Yt.a.interceptors.response.use(function(t){return 403==t.data.code?(window.localStorage.removeItem("token"),void window.bus.$emit("kick")):t},function(t){return window.bus.$emit("kick"),s.a.reject(t)}),n["default"].prototype.$http=Yt.a,n["default"].config.productionTip=!1,window.bus=new n["default"],Bt.afterEach(function(t,e){localStorage.token?Yt.a.post("/api.php",f.a.stringify({class:"dashboard",method:"noop",token:localStorage.token})).then(function(t){t&&200!=t.data.code&&Bt.push({path:"/"})}):Bt.push({path:"/"})}),new n["default"]({router:Bt,render:function(t){return t(y)}}).$mount("#app"),Date.prototype.format=function(t){var e=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i={"y+":this.getFullYear(),"m+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"i+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),n:this.getMilliseconds(),M:e[this.getMonth()],W:a[this.getDay()]};for(var s in i)new RegExp("("+s+")").test(t)&&(t="y+"==s?t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)):t.replace(RegExp.$1,1==RegExp.$1.length?i[s]:("00"+i[s]).substr((""+i[s]).length)));return t}},"589b":function(t,e,a){"use strict";var i=a("7522"),s=a.n(i);s.a},"5d46":function(t,e,a){"use strict";var i=a("91bd"),s=a.n(i);s.a},"636a":function(t,e,a){"use strict";var i=a("2d06"),s=a.n(i);s.a},"6b85":function(t,e,a){},7258:function(t,e,a){"use strict";var i=a("0517"),s=a.n(i);s.a},7522:function(t,e,a){},"8a72":function(t,e,a){"use strict";var i=a("6b85"),s=a.n(i);s.a},"91bd":function(t,e,a){},a02a:function(t,e,a){},a499:function(t,e,a){},b21a:function(t,e,a){"use strict";var i=a("def2"),s=a.n(i);s.a},bfc9:function(t,e,a){"use strict";var i=a("a499"),s=a.n(i);s.a},d9ab:function(t,e,a){"use strict";var i=a("a02a"),s=a.n(i);s.a},da00:function(t,e,a){},def2:function(t,e,a){},e3ab:function(t,e,a){"use strict";var i=a("3995"),s=a.n(i);s.a}});