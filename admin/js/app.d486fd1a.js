(function(e){function t(t){for(var i,s,o=t[0],l=t[1],c=t[2],d=0,p=[];d<o.length;d++)s=o[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&p.push(n[s][0]),n[s]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],i=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=a[0]))}return e}var i={},n={app:0},r=[];function s(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=i,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0794":function(e,t,a){},"25c3":function(e,t,a){"use strict";a("adcf")},"330c":function(e,t,a){"use strict";a("aaa6")},"3f01":function(e,t,a){"use strict";a("4f77")},"4f77":function(e,t,a){},"52ab":function(e,t,a){"use strict";a("cad7")},"52f9":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("c975"),a("d3b7"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view",{staticClass:"router",class:{full:"/login"==e.$route.path||"/"==e.$route.path}}),"/login"!=e.$route.path&&"/"!=e.$route.path?a("side"):e._e(),a("el-backtop",{attrs:{target:"body"}})],1)},r=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"side"},[a("div",{staticClass:"info"},[""!=e.photo?a("span",{staticClass:"photo",style:{"background-image":"url("+this.photo+")"}}):e._e(),""==e.photo?a("span",{staticClass:"photo"},[e._v(e._s(e.nickname.substr(0,1)))]):e._e(),a("div",{staticClass:"account"},[e._v(e._s(e.nickname))]),a("div",{staticClass:"other"},[a("span",{on:{click:function(t){return e.profile()}}},[e._v("修改密码")]),a("span",{on:{click:function(t){return e.clear()}}},[e._v("清理缓存")])])]),a("el-scrollbar",{attrs:{"wrap-class":"menu-scrollbar","view-class":"view-box"}},[a("el-menu",{staticClass:"el-menu-vertical-side",on:{select:e.select}},[a("el-menu-item",{class:{active:"dashboard"==e.active},attrs:{index:"dashboard"}},[a("i",{staticClass:"icon-monitor"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("仪表板")])]),e._l(e.permissions,(function(t){return a("el-menu-item",{key:t.key,class:{active:e.active==t.key},attrs:{index:t.key}},[a("i",{class:[t.icon]}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.name))])])})),a("el-menu-item",{class:{active:"logout"==e.active},attrs:{index:"logout"}},[a("i",{staticClass:"icon-outbox"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("退出")])])],2)],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,width:"320px","append-to-body":!0},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",{ref:"post"},[a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"新密码（5-20个字符）",type:"password",maxlength:"20",clearable:""},model:{value:e.dialog.password,callback:function(t){e.$set(e.dialog,"password",t)},expression:"dialog.password"}})],1)],1),a("el-row",[a("el-col",{attrs:{align:"right"}},[a("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatePassword()}}},[e._v("确 定")])],1)],1)],1)],1)},o=[],l=(a("4de4"),a("caad"),a("2532"),a("96cf"),a("1da1")),c=[{name:"文章管理",key:"post",icon:"icon-paper"},{name:"标签管理",key:"tag",icon:"icon-tag"},{name:"链接管理",key:"link",icon:"icon-link"},{name:"会员管理",key:"user",icon:"icon-head"},{name:"数据备份/还原",key:"backup",icon:"icon-paper"},{name:"全局设置",key:"config",icon:"icon-server",super:!0}],u=a("4328"),d=a.n(u),p={name:"side",data:function(){var e=atob(window.localStorage.permission);return{permissions:"super"!=e?c.filter((function(t){return e.includes(t.key)})):c,active:"",info:!1,account:window.localStorage.account,nickname:window.localStorage.nickname,photo:window.localStorage.photo,dialog:{title:"",show:!1,edit:!1,password:""}}},mounted:function(){var e=this;this.$nextTick((function(){e.info=!0,window.bus.$on("nav",(function(t){return e.active=t}))}))},methods:{select:function(e){if("logout"==e)return window.localStorage.removeItem("token"),void this.$router.push({path:"/"});"post-article"==e&&(e="post"),this.$router.push({path:"/"+e})},backup:function(){this.$router.push({path:"/backup"})},logout:function(){window.localStorage.removeItem("token"),this.$router.push({path:"/"})},profile:function(){this.dialog.show=!0,this.dialog.edit=!0,this.dialog.title="修改密码",this.dialog.password=""},clear:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={token:localStorage.token,class:"dashboard",method:"clear"},t.next=3,e.$http.post("/api.php",d.a.stringify(a));case 3:return i=t.sent,t.prev=4,t.next=7,i.data;case 7:n=t.sent,200==n.code?e.$message.success("清理成功"):e.$message.error(n.info),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.$message.error("网络异常");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()},updatePassword:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.dialog.password){t.next=3;break}return e.$message.error("密码不能为空"),t.abrupt("return");case 3:if(!(e.dialog.password.length<5)){t.next=6;break}return e.$message.error("密码不能小于5位"),t.abrupt("return");case 6:return a={token:localStorage.token,class:"user",method:"update_password",id:window.localStorage.id,password:e.dialog.password},t.next=9,e.$http.post("/api.php",d.a.stringify(a));case 9:return i=t.sent,t.prev=10,t.next=13,i.data;case 13:n=t.sent,200==n.code?(e.dialog.show=!1,e.logout()):e.$message.error(n.info),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](10),e.$message.error("网络异常");case 20:case"end":return t.stop()}}),t,null,[[10,17]])})))()}}},f=p,g=(a("8a72"),a("2877")),m=Object(g["a"])(f,s,o,!1,null,null,null),h=m.exports,v={name:"app",components:{side:h},created:function(){var e=this;window.bus.$on("kick",(function(){e.$router.push({path:"/"})}))}},b=v,w=(a("5d46"),Object(g["a"])(b,n,r,!1,null,null,null)),k=w.exports,_=a("8c4f"),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"box"},[e._m(0),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box-content"},[a("el-row",[a("el-col",{attrs:{span:4}},[e._v("服务器域名")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{type:"primary",href:e.domain,target:"_blank"}},[e._v(e._s(e.info.domain))])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("服务器时间")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.time))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("服务器引擎")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.software))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("服务器系统")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.os))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("PHP版本")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{type:"primary",href:"https://php.net",target:"_blank"}},[e._v(e._s(e.info.php_version))])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("PHP 运行方式")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.run_mode))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("MySQL 版本")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.mysql_version))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("最大上传")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.upload_max_filesize))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("最大POST提交")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.post_max_size))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("硬盘可用空间")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.disk_free_space))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("脚本超时时间")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.max_execution_time))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("网站根目录")]),a("el-col",{attrs:{span:20}},[e._v(e._s(e.info.document_root))])],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("网站默认主题")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{type:"success",title:"点击切换主题"},on:{click:function(t){e.dialog.show=!0}}},[e._v(e._s(e.info.theme_dir))])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[e._v("网站程序版本")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{title:"获取最新版本",type:"danger",href:"https://github.com/jinzhe/gum",target:"_blank"}},[e._v(e._s(e.info.version))])],1)],1),""!=e.version?a("el-row",[a("el-col",{attrs:{span:4}},[e._v("最新程序版本")]),a("el-col",{attrs:{span:20}},[a("el-link",{attrs:{title:"获取最新版本",type:"warning",href:"https://github.com/jinzhe/gum",target:"_blank"}},[e._v(e._s(e.version))])],1)],1):e._e()],1)]),""!=e.info.disable_functions?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[e._m(1),a("div",{staticClass:"box-content"},[e._v(e._s(e.info.disable_functions))])]):e._e(),e.info.extensions?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[e._m(2),a("div",{staticClass:"box-content"},[e._v(e._s(e.info.extensions.join(",")))])]):e._e(),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.dialog.loading,expression:"dialog.loading"}],attrs:{title:"默认主题",visible:e.dialog.show,width:"50%"},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[e._l(e.info.theme_dirs,(function(t){return a("el-button",{key:t,class:{"el-button--primary":t==e.info.theme_dir},nativeOn:{click:function(a){return e.setTheme(t)}}},[e._v(e._s(t))])})),a("br"),a("br"),a("div",{staticClass:"important warn"},[a("strong",[e._v("说明")]),a("br"),e._v("切换后会自动将主题配置文件中的config全局设置变量导入到数据库中，如果数据库中已经存在则不会导入。 ")])],2)],1)},y=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-header"},[e._v("服务器"),a("p",[e._v("服务器基本信息、程序版本、主题等")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-header"},[e._v("禁用函数"),a("p",[e._v("被禁用的PHP函数")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box-header"},[e._v("扩展模块"),a("p",[e._v("支持的PHP扩展模块")])])}],$={name:"dashboard",data:function(){return{domain:localStorage.server,first:!0,loading:!1,dialog:{show:!1,loading:!1},version:"",info:{}}},mounted:function(){var e=this;this.$nextTick((function(){setTimeout((function(e){window.bus.$emit("nav","dashboard")}),100),e.getData(),e.getVersion()}))},methods:{getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"dashboard",method:"info"},t.next=4,e.$http.get("/api.php",{params:a});case 4:return i=t.sent,t.next=7,i.data;case 7:n=t.sent,200==n.code?(e.info=n.result,e.loading=!1,e.first=!1):e.$message.error(n.code);case 9:case"end":return t.stop()}}),t)})))()},getVersion:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return{class:"dashboard",method:"version"},t.next=3,e.$http.get("https://zee.kim/api.php?class=dashboard&method=version");case 3:return a=t.sent,t.next=6,a.data;case 6:i=t.sent,200==i.code&&(e.version=i.version);case 8:case"end":return t.stop()}}),t)})))()},setTheme:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialog.loading=!0,i={token:localStorage.token,class:"dashboard",method:"theme",dir:e},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.next=7,n.data;case 7:r=a.sent,200==r.code?(t.getData(),t.dialog.show=!1,t.dialog.loading=!1):t.$message.error(r.code);case 9:case"end":return a.stop()}}),a)})))()}}},S=$,C=(a("f019"),Object(g["a"])(S,x,y,!1,null,"5e5293ee",null)),D=C.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("el-form",{staticClass:"login-form"},[a("header",[e._v("管理登录")]),a("main",[a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-server",placeholder:"服务器",autocomplete:"off",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.server,callback:function(t){e.server=t},expression:"server"}})],1),a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-head",placeholder:"账号",autocomplete:"off",maxlength:"20",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}})],1),a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"icon-lock",autocomplete:"off",placeholder:"密码",type:"password",maxlength:"20",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("el-form-item",[a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},on:{click:e.login}},[e._v("立即登录")])],1)],1)])],1)},R=[],j={name:"login",data:function(){return{loading:!1,server:"",account:"",password:""}},mounted:function(){window.localStorage.token&&this.$router.push({path:"/dashboard"}),window.localStorage.server?this.server=window.localStorage.server:this.server=window.location.protocol+"//"+window.location.host},methods:{login:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.account){t.next=3;break}return e.$message.error("账号不能为空"),t.abrupt("return");case 3:if(""!=e.password){t.next=6;break}return e.$message.error("密码不能为空"),t.abrupt("return");case 6:return e.loading=!0,a={token:localStorage.token,class:"user",method:"login",account:e.account,password:e.password},window.localStorage.server=e.server,e.$http.defaults.baseURL=window.localStorage.server,t.next=12,e.$http.post("/api.php",d.a.stringify(a));case 12:return i=t.sent,t.prev=13,t.next=16,i.data;case 16:if(n=t.sent,200!=n.code){t.next=33;break}if(255==n.result.level){t.next=22;break}return e.loading=!1,e.$message.error("登陆失败"),t.abrupt("return");case 22:window.localStorage.token=n.token,window.localStorage.id=n.result.id,window.localStorage.account=n.result.account,window.localStorage.nickname=n.result.nickname,window.localStorage.photo=n.result.photo,window.localStorage.permission=btoa(n.result.permission),e.loading=!1,e.$message.success("登陆成功"),e.$router.push({path:"/dashboard"}),t.next=34;break;case 33:404==n.code?(e.loading=!1,e.$message.error("登陆失败")):(e.$message.error(n.code),e.loading=!1);case 34:t.next=40;break;case 36:t.prev=36,t.t0=t["catch"](13),e.$message.error("服务器无法链接"),e.loading=!1;case 40:case"end":return t.stop()}}),t,null,[[13,36]])})))()}}},z=j,E=(a("52ab"),a("9ef5"),Object(g["a"])(z,O,R,!1,null,"60934e90",null)),T=E.exports,P=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},N=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"notfound"},[e._v(" 404 "),a("p",[e._v("对不起，找不到页面！")])])])}],I=(a("d9ab"),{}),M=Object(g["a"])(I,P,N,!1,null,"308a9930",null),F=M.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:20}},[a("h1",[e._v("文章管理")]),a("p",[e._v("可作为发布新闻、通知、笔记等信息。")])]),a("el-col",{attrs:{span:4,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.publish()}}},[e._v("新增")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:e.filter}},[a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"标签"},model:{value:e.filter.tag_id,callback:function(t){e.$set(e.filter,"tag_id",t)},expression:"filter.tag_id"}},e._l(e.tags,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-input",{staticStyle:{width:"150px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"关键字",maxlength:"10",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterSubmit()}},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword",t)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","picker-options":e.filter.timeOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期",align:"center"},model:{value:e.filter.time,callback:function(t){e.$set(e.filter,"time",t)},expression:"filter.time"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[a("el-option",{attrs:{label:"已发布",value:"1"}}),a("el-option",{attrs:{label:"未发布",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.filterSubmit()}}},[e._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(t){return e.filterReset()}}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.items.data,"tooltip-effect":"dark",stripe:""},on:{"selection-change":e.onSelection}},[a("el-table-column",{attrs:{type:"selection",width:"48",align:"center"}}),a("el-table-column",{attrs:{label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){return a("span",{staticClass:"title",on:{click:function(a){return e.editData(t.row)}}},[a("el-tag",{attrs:{"disable-transitions":e.bool,type:"info",size:"small"}},[e._v(" "+e._s(t.row.tag_name)+" ")]),""!=t.row.cover?a("el-popover",{attrs:{trigger:"hover",placement:"right"}},[a("img",{attrs:{src:t.row.cover,align:"absmiddle",width:"200"}}),a("span",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.title))])]):e._e(),""==t.row.cover?a("span",[e._v(e._s(t.row.title))]):e._e(),e._v(" "),1==t.row.best?a("el-tag",{attrs:{"disable-transitions":!0,type:"primary",size:"small"}},[e._v("推荐")]):e._e()],1)}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v("作者: "+e._s(t.row.author))]),a("p",[e._v("日期: "+e._s(t.row.time))]),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[1==t.row.status?a("el-tag",{attrs:{"disable-transitions":e.bool,type:"success",size:"small"}},[e._v("已发布")]):e._e(),0==t.row.status?a("el-tag",{attrs:{"disable-transitions":e.bool,type:"danger",size:"small"}},[e._v("未发布")]):e._e()],1)])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")])]}}])})],1)],1),e.items.data&&e.items.data.length>0?a("div",{staticClass:"box-footer"},[a("el-row",{attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.batchDeleteData}},[e._v("批量删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("el-pagination",{attrs:{background:"","current-page":e.pagination.index,layout:"total, prev, pager, next,jumper",total:e.items.total,"page-size":e.pagination.size},on:{"current-change":e.onPagination}})],1)],1)],1):e._e()]),e._m(0)],1)])},U=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"important warn"},[a("strong",[e._v("使用帮助")]),a("br"),e._v("1.当使用了搜索功能后，会保存上一次搜索参数，如果需要清除点击重置按钮即可。 "),a("br"),e._v("2.附件功能中的文件即使在页面删除也不会真正删除物理文件，需要清理缓存才会批量删除会未使用的上传文件。 ")])}],q=(a("4160"),a("a15b"),a("d81d"),a("159b"),{name:"post",data:function(){return{bool:!0,loading:!1,first:!0,filter:{keyword:"",status:"",time:"",timeOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}},tags:[],items:[],pagination:{size:10,index:1},multipleSelection:[]}},mounted:function(){var e=this;this.$nextTick((function(){setTimeout((function(e){window.bus.$emit("nav","post")}),100),window.localStorage.postIndex&&(e.pagination.index=window.localStorage.postIndex>>0),window.localStorage.postFilter&&(e.filter=JSON.parse(window.localStorage.postFilter)),e.getTags(),e.getData()}))},methods:{getTags:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={token:localStorage.token,class:"tag",method:"data",data:'{"hot":1000}'},t.next=3,e.$http.get("/api.php",{params:a});case 3:return i=t.sent,t.prev=4,t.next=7,i.data;case 7:n=t.sent,e.tags=n.result.hot,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.$message.error("网络异常");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()},publish:function(){this.$router.push({path:"/post-form"})},filterSubmit:function(){window.localStorage.postFilter=JSON.stringify(this.filter),window.localStorage.postIndex=this.pagination.index,this.getData()},filterReset:function(){window.localStorage.removeItem("postFilter"),window.localStorage.removeItem("postIndex"),this.filter.keyword="",this.filter.status="",this.filter.time="",this.filter.tag_id="",this.pagination.index=1,this.getData()},onPagination:function(e){window.localStorage.postIndex=e,this.pagination.index=e,this.getData()},onSelection:function(e){this.multipleSelection=e},batchDeleteData:function(){var e=this;if(0==this.multipleSelection.length)return this.$message.warning("至少选择一个"),!1;var t=this.multipleSelection.map((function(e){return e.id})).join(",");this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,i={token:localStorage.token,class:"post",method:"delete",ids:t},a.next=4,e.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:r=a.sent,200==r.code?(e.loading=!1,e.getData()):e.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),e.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[5,12]])}))))},editData:function(e){this.$router.push({path:"/post-form",query:{id:e.id}})},deleteData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"post",method:"delete",ids:e.id},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:r=a.sent,200==r.code?(t.loading=!1,t.getData()):t.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[5,12]])}))));case 1:case"end":return a.stop()}}),a)})))()},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"post",method:"search",page_index:e.pagination.index,page_size:e.pagination.size},""!=e.filter.keyword&&(a.keyword=e.filter.keyword),""!=e.filter.time&&(a.begin=+new Date(e.filter.time[0])/1e3>>0,a.end=+new Date(e.filter.time[1])/1e3>>0),""!=e.filter.status&&(a.status=e.filter.status),""!=e.filter.tag_id&&(a.tag_id=e.filter.tag_id),t.next=8,e.$http.get("/api.php",{params:a});case 8:return i=t.sent,t.prev=9,t.next=12,i.data;case 12:n=t.sent,n.result.data.forEach((function(e){e.time=new Date(1e3*e.time).format("yyyy/mm/dd")})),e.items=n.result,e.loading=!1,e.first=!1,t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](9),e.$message.error("网络异常");case 22:case"end":return t.stop()}}),t,null,[[9,19]])})))()}}}),L=q,V=(a("25c3"),Object(g["a"])(L,J,U,!1,null,"1d86534c",null)),B=V.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[a("h1",[e._v(e._s(e.edit?"更新文章":"发布文章"))]),a("p",[e._v("可作为发布新闻、通知、笔记等信息。")])]),a("el-col",{attrs:{span:8,align:"right"}},[e.edit?e._e():a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.saveDraft()}}},[e._v("存草稿")]),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submit()}}},[e._v(e._s(e.edit?"更新":"发布"))])],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[e._v("主要内容"),a("p",[e._v("内容最多写约 20000 汉字或64kb容量大小")])]),a("div",{staticClass:"box-content"},[a("el-form",{ref:"post",attrs:{model:e.post}},[a("el-form-item",{attrs:{prop:"title"}},[a("el-input",{attrs:{placeholder:"标题（5-30字）",maxlength:"30",clearable:""},model:{value:e.post.title,callback:function(t){e.$set(e.post,"title",t)},expression:"post.title"}})],1),a("editor",{ref:"editor",model:{value:e.post.content,callback:function(t){e.$set(e.post,"content",t)},expression:"post.content"}})],1)],1)]),a("div",{staticClass:"important warn"},[a("strong",[e._v("上传说明")]),a("br"),e._v("1.缩图上传会自动压缩到600x600。 "),a("br"),e._v("2.附件中上传的照片图片会按比例自动压缩到1200x1200的范围。 "),a("br"),e._v("3.如果安装了exif扩展可以解决iPhone拍出来的照片自动纠正方向。 "),a("br"),e._v("4.上传允许 jpg/png/gif/pdf/mp4/mov/mp3/psd/json/svg/docx/pptx/xlsx/ppt/xls/doc/zip/rar "),a("br"),e._v("5.PHP的GD库需要2.1以上版本最佳。 "),a("br"),e._v("6.上传文件需要考虑到 最大上传限制 和 最大POST提交限制。 "),a("br"),e._v("7.上传环境需要确保服务器地址和后台域名一致（包含协议，如：https）。 ")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.upload.file.loading,expression:"upload.file.loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[a("el-row",[a("el-col",{attrs:{span:20}},[e._v(" 附件"),a("p",[e._v("上传图片、文档、压缩包")])]),a("el-col",{attrs:{span:4,align:"right"}},[a("el-upload",{attrs:{multiple:"",action:e.upload.file.action,data:e.upload.data,"show-file-list":!1,"on-success":e.upload.file.success,"before-upload":e.upload.file.before,"on-progress":e.upload.file.progress}},[a("el-button",{attrs:{size:"mini",type:"primary"}},[e._v(" 上传 "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],1)],1)],1),a("div",{staticClass:"box-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.post.files,stripe:"","show-overflow-tooltip":""}},[a("el-table-column",{attrs:{label:"文件"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{on:{click:function(a){return e.addFile(t.row)}}},[t.row.image?[a("img",{attrs:{src:t.row.url,height:"30",align:"absmiddle"}})]:[e._v(e._s(t.row.name))]],2)}}])}),a("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return["video/mp4"==t.row.type?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.addFile(t.row)}}},[e._v("插入")]):e._e(),t.row.image?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.previewFile(t.row.url)}}},[e._v("预览")]):e._e(),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.deleteFile(t.$index)}}},[e._v("删除")])]}}])})],1),e._l(e.post.files,(function(e,t){return a("el-row",{key:t},[a("el-col",{attrs:{span:12}}),a("el-col",{attrs:{span:12}})],1)}))],2)])]),a("el-col",{attrs:{span:8}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[a("el-row",{staticClass:"caption",staticStyle:{"margin-bottom":"0"},attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[e._v(" 封面"),a("p",[e._v("作为文章的封面")])]),a("el-col",{attrs:{span:8,align:"right"}},[""!=e.post.cover?a("a",{staticStyle:{color:"green",cursor:"pointer"},on:{click:function(t){return e.previewFile(e.post.cover)}}},[e._v("预览")]):e._e()])],1)],1),a("div",{staticClass:"box-content"},[a("el-upload",{staticClass:"cover",attrs:{action:e.upload.cover.action,data:e.upload.data,"show-file-list":!1,"on-success":e.upload.cover.success,"before-upload":e.upload.cover.before}},[""!=e.post.cover?a("img",{attrs:{src:e.post.cover,width:"100%",align:"absmiddle"}}):e._e(),""==e.post.cover?a("div",{staticStyle:{display:"block"}},[e._v("上传本地图片")]):e._e()]),""!=e.post.cover?a("div",{staticClass:"delete",on:{click:function(t){return t.stopPropagation(),e.clearCover(t)}}}):e._e()],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[e._v("标签"),a("p",[e._v("作为关联文章类别")])]),a("div",{staticClass:"box-content"},e._l(e.tags,(function(t,i){return a("el-button",{key:i,staticStyle:{margin:"0 5px 5px 0"},attrs:{round:"",type:t.type},on:{click:function(a){return e.setTag(t)}}},[e._v(e._s(t.name))])})),1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[e._v("作者"),a("p",[e._v("文章的作者")])]),a("div",{staticClass:"box-content"},[a("el-input",{attrs:{placeholder:"10字内",maxlength:"10",clearable:""},model:{value:e.post.author,callback:function(t){e.$set(e.post,"author",t)},expression:"post.author"}})],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[e._v("关键字"),a("p",[e._v("提供给搜索引擎使用")])]),a("div",{staticClass:"box-content"},[a("el-input",{attrs:{placeholder:"例如: GUM,PHP",maxlength:"80",clearable:""},model:{value:e.post.keywords,callback:function(t){e.$set(e.post,"keywords",t)},expression:"post.keywords"}})],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[e._v("描述"),a("p",[e._v("提供给搜索引擎使用")])]),a("div",{staticClass:"box-content"},[a("el-input",{attrs:{placeholder:"用于文章摘要，SEO描述",maxlength:"200",type:"textarea",rows:5,clearable:""},model:{value:e.post.description,callback:function(t){e.$set(e.post,"description",t)},expression:"post.description"}})],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box"},[a("div",{staticClass:"box-header"},[e._v("属性"),a("p",[e._v("文章状态")])]),a("div",{staticClass:"box-content"},[a("el-checkbox",{attrs:{label:"推荐",name:"best"},model:{value:e.post.best,callback:function(t){e.$set(e.post,"best",t)},expression:"post.best"}}),a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:e.post.status,callback:function(t){e.$set(e.post,"status",t)},expression:"post.status"}})],1)])])],1)],1)])},A=[],G=(a("99af"),a("a434"),a("b0c0"),a("5530")),W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tinymce-editor"},[a("editor",{attrs:{init:e.init,disabled:e.disabled},on:{onClick:e.onClick},model:{value:e.myValue,callback:function(t){e.myValue=t},expression:"myValue"}})],1)},Y=[],Q=(a("a9e3"),a("e562")),Z=a.n(Q),K=a("ca72"),X=(a("ec27"),a("0d68"),a("4ea8"),a("64d8"),a("07d7"),a("2fec"),a("4237"),a("3aea"),a("07d1"),a("84ec"),a("0a9d"),a("f557"),a("9434"),a("bc54"),a("2d33"),a("34de"),a("3154"),a("840a"),a("55a0"),a("c3d7"),{components:{Editor:K["a"]},props:{value:{type:String,default:""},disabled:{type:Boolean,default:!1},height:{type:Number,default:360},plugins:{type:[String,Array],default:"print tabfocus preview fullscreen autolink link charmap lists image code codesample media table colorpicker textcolor wordcount contextmenu media paste"},toolbar:{type:[String,Array],default:"formatselect bold italic underline strikethrough  forecolor backcolor | align bullist numlist outdent indent blockquote | link table image media | print  pastetext fullscreen code"}},data:function(){return{init:{convert_urls:!1,codesample_dialog_width:1e3,codesample_dialog_height:400,force_p_newlines:!1,language_url:"tinymce/langs/zh_CN.js",language:"zh_CN",skin_url:"tinymce/skins/ui/oxide",height:this.height,plugins:this.plugins,toolbar:"formatselect fontsizeselect link table image media pastetext code codesample   charmap  autolink colorpicker  bold italic underline strikethrough  forecolor backcolor align bullist numlist outdent indent blockquote fullscreen preview print",branding:!1,menubar:!1,paste_data_images:!0},myValue:this.value}},mounted:function(){Z.a.init({})},methods:{onClick:function(e){this.$emit("onClick",e,Z.a)}},watch:{value:function(e){this.myValue=e},myValue:function(e){this.$emit("input",e)}}}),ee=X,te=Object(g["a"])(ee,W,Y,!1,null,null,null),ae=te.exports,ie={components:{editor:ae},data:function(){var e=this;return{edit:!1,loading:!1,draftInterval:null,upload:{data:{token:localStorage.token},cover:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=post&original=600x600",before:function(t){var a="image/jpeg"===t.type,i=t.size/1024/1024<10;return a||e.$message.error("上传头像图片只能是 JPG 格式!"),i||e.$message.error("上传头像图片大小不能超过 10MB!"),a&&i},success:function(t){200==t.code?(e.post.cover=t.result.url,e.post.cover_id=t.result.id):e.$message.error(t.info)}},file:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=post&original=1200x1200",before:function(t){var a=t.size/1024/1024<50;return a||e.$message.error("上传大小不能超过 50MB!"),a},loading:!1,progress:function(t){var a=Math.floor(t.loaded/t.total*100);a<100&&(e.upload.file.loading=!0)},success:function(t){e.upload.file.loading=!1,200==t.code?e.post.files.push(t.result):e.$message.error(t.info)}}},tags:[],races:[],post:{title:"",content:"",author:"",cover:"",cover_id:"",file:"",keywords:"",description:"",best:!1,status:!0,tag_id:0,tag_name:"",files:[]}}},mounted:function(){var e=this;this.$nextTick((function(t){if(setTimeout((function(e){window.bus.$emit("nav","post")}),100),e.$route.query.id)e.edit=!0,e.getData();else{var a=localStorage.draft;a&&(a=JSON.parse(a),e.post=a,e.$message.success("已从草稿中恢复")),e.getTags()}}))},methods:{saveDraft:function(){""==this.post.title&&""==this.post.content||(window.localStorage.draft=JSON.stringify(this.post),this.$message.success("草稿已保存"))},setContent:function(e){tinymce.activeEditor.execCommand("mceInsertContent",!1,e),this.post.content=Z.a.activeEditor.getContent()},addFile:function(e){e.image?this.setContent('<img src="'.concat(e.url,'" style="max-width:100%">')):"video/mp4"==e.type?this.setContent('<video controls="controls" width="720" height="480"><source src="'.concat(e.url,'" type="video/mp4" /></video>')):this.setContent('<a href="'.concat(e.url,'">').concat(e.name,"</a>"))},setCover:function(e){this.post.cover=e.url,this.post.cover_id=e.id},clearCover:function(){this.post.cover="",this.post.cover_id=""},previewFile:function(e){window.open(e)},deleteFile:function(e){this.post.files.splice(e,1)},setTag:function(e){this.tags.forEach((function(e){return e.type=""})),e.type="primary",this.post.tag_id=e.id,this.post.tag_name=e.name,2==e.id&&this.getRaces()},getTags:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={token:localStorage.token,class:"tag",method:"data",data:'{"hot":1000}'},t.next=4,e.$http.get("/api.php",{params:a});case 4:return i=t.sent,t.next=7,i.data;case 7:n=t.sent,r=[],n.result.hot.forEach((function(t){e.post.tag_id==t.id?(t.type="primary",e.post.tag_name=t.name):t.type="",r.push(t)})),e.tags=r,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),e.$message.error("网络异常");case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},getBindTags:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={token:localStorage.token,class:"tag",method:"data",data:'{"bind_id":'+e.$route.query.id+',"bind_type":"post"}'},t.next=4,e.$http.get("/api.php",{params:a});case 4:return i=t.sent,t.next=7,i.data;case 7:n=t.sent,r=[],n.result.bind.forEach((function(e){r.push(e)})),e.post.tags=r,e.$forceUpdate(),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),e.$message.error("网络异常");case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))()},getBindFiles:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a={token:localStorage.token,class:"upload",method:"data",data:'{"bind_id":'+e.$route.query.id+',"bind_type":"post"}'},t.next=4,e.$http.get("/api.php",{params:a});case 4:return i=t.sent,t.next=7,i.data;case 7:n=t.sent,200==n.code?(r=[],n.result.bind.forEach((function(t){t.id!=e.post.cover_id&&r.push(t)})),e.post.files=r,e.$forceUpdate()):e.$message.error(n.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),e.$message.error("网络异常");case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,a={token:localStorage.token,class:"post",method:"get",id:e.$route.query.id},t.next=5,e.$http.get("/api.php",{params:a});case 5:return i=t.sent,t.next=8,i.data;case 8:n=t.sent,200==n.code?(n.result.files=[],n.result.tags=[],n.result.best=1==n.result.best,n.result.status=1==n.result.status,e.post=n.result,e.loading=!1,e.getTags(),e.getBindFiles()):e.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),e.$message.error("网络异常");case 15:case"end":return t.stop()}}),t,null,[[1,12]])})))()},submit:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.post.title){t.next=3;break}return e.$message.error("标题不能为空"),t.abrupt("return");case 3:if(""!=e.post.content){t.next=6;break}return e.$message.error("内容不能为空"),t.abrupt("return");case 6:if(""!=e.post.tag_id){t.next=9;break}return e.$message.error("标签至少选择一个"),t.abrupt("return");case 9:return e.loading=!0,e.post.keywords=e.post.keywords.replace(/，/g,","),a=JSON.parse(JSON.stringify(e.post)),a.file_ids=a.files.map((function(e){return e.id})).join(","),a.best=a.best?1:0,a.status=a.status?1:0,delete a.files,i=Object(G["a"])({token:localStorage.token,class:"post",method:"save",id:e.$route.query.id},a),t.next=19,e.$http.post("/api.php",d.a.stringify(i));case 19:return n=t.sent,t.prev=20,t.next=23,n.data;case 23:r=t.sent,200==r.code?(localStorage.removeItem("draft"),e.loading=!1,e.$router.replace({path:"/post"})):e.$message.error(r.code),t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](20),e.$message.error("网络异常");case 30:case"end":return t.stop()}}),t,null,[[20,27]])})))()}}},ne=ie,re=(a("e3ab"),Object(g["a"])(ne,H,A,!1,null,null,null)),se=re.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[a("h1",[e._v("会员管理")]),a("p",[e._v("管理员、会员账号管理")])]),a("el-col",{attrs:{span:8,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addData()}}},[e._v("新增")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:e.filter}},[a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"ID/邮箱/手机/昵称",maxlength:"10",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterSubmit()}},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword",t)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-date-picker",{staticStyle:{width:"260px"},attrs:{type:"daterange","picker-options":e.filter.timeOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期",align:"center"},model:{value:e.filter.time,callback:function(t){e.$set(e.filter,"time",t)},expression:"filter.time"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.filterSubmit()}}},[e._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(t){return e.filterReset()}}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.items.data,"tooltip-effect":"dark",stripe:""},on:{"selection-change":e.onSelection}},[a("el-table-column",{attrs:{type:"selection",selectable:e.canSelectable,width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"address",label:"头像",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!=t.row.photo?a("img",{staticClass:"photo",attrs:{src:t.row.photo,width:"50",height:"50"}}):e._e(),""==t.row.photo?a("div",{staticClass:"photo"},[e._v(e._s(t.row.nickname.substr(0,1)))]):e._e()]}}])}),a("el-table-column",{attrs:{label:"账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.account)+" ("+e._s(t.row.nickname)+") "),255==t.row.level?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("管理员")]):e._e(),t.row.email?[a("br"),e._v(" 邮箱："+e._s(t.row.email)+" "),t.row.email_verification?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}):e._e()]:e._e(),t.row.tel?[a("br"),e._v(" 手机："+e._s(t.row.tel)+" "),t.row.tel_verification?a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}):e._e()]:e._e()]}}])}),a("el-table-column",{attrs:{prop:"address",label:"登陆",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.login_time)+" "),a("br"),a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v(" "+e._s(t.row.login_ip)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"address",label:"注册",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.join_time)+" "),a("br"),a("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v(" "+e._s(t.row.join_ip)+" ")])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-tag",{attrs:{type:"success",size:"small"}},[e._v("启用")]):e._e(),0==t.row.status?a("el-tag",{attrs:{type:"danger",size:"small"}},[e._v("禁用")]):e._e()]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("编辑")]),t.row.id!=e.id?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteData(t.row.id)}}},[e._v("删除")]):e._e()]}}])})],1)],1),a("div",{staticClass:"box-footer"},[a("el-row",{attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.batchDeleteData}},[e._v("批量删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:18}},[a("el-pagination",{attrs:{background:"","current-page":e.pagination.index,layout:"total, prev, pager, next,jumper",total:e.items.count,"page-size":e.pagination.size},on:{"current-change":e.onPagination}})],1)],1)],1)])],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,width:"500px"},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",{ref:"post",attrs:{model:e.dialog.fields}},[a("el-row",{attrs:{gutter:20,type:"flex"}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"form-photo",style:{"background-image":"url("+this.dialog.fields.photo+")"}},[a("el-upload",{staticClass:"el-upload",attrs:{action:e.upload.action,data:e.upload.data,"show-file-list":!1,"on-success":e.upload.success,"before-upload":e.upload.before}},[""==e.dialog.fields.photo?a("div",{staticClass:"el-icon-picture-outline avatar-uploader-icon"}):e._e()]),""!=e.dialog.fields.photo?a("div",{staticClass:"delete",on:{click:function(t){t.stopPropagation(),e.dialog.fields.photo=""}}}):e._e()],1)]),a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{prop:"account"}},[a("el-input",{attrs:{placeholder:"账号（3-20个由英文字母开头的字母）",maxlength:"20",disabled:e.dialog.edit,readonly:e.dialog.edit,clearable:""},model:{value:e.dialog.fields.account,callback:function(t){e.$set(e.dialog.fields,"account",t)},expression:"dialog.fields.account"}})],1),a("el-form-item",{attrs:{prop:"password"}},[e.dialog.edit?e._e():a("el-input",{attrs:{placeholder:"密码（5-20个字符）",type:"password",maxlength:"20",clearable:""},model:{value:e.dialog.fields.password,callback:function(t){e.$set(e.dialog.fields,"password",t)},expression:"dialog.fields.password"}}),e.dialog.edit?a("el-input",{attrs:{placeholder:"密码（不修改请留空，5-20个字符）",type:"password",maxlength:"20",clearable:""},model:{value:e.dialog.fields.password,callback:function(t){e.$set(e.dialog.fields,"password",t)},expression:"dialog.fields.password"}}):e._e()],1),a("el-form-item",{attrs:{prop:"nickname"}},[a("el-input",{attrs:{placeholder:"昵称（3-10个字）",maxlength:"10",clearable:""},model:{value:e.dialog.fields.nickname,callback:function(t){e.$set(e.dialog.fields,"nickname",t)},expression:"dialog.fields.nickname"}})],1),a("el-form-item",{attrs:{prop:"email"}},[a("el-input",{attrs:{placeholder:"邮箱地址",maxlength:"100",clearable:""},model:{value:e.dialog.fields.email,callback:function(t){e.$set(e.dialog.fields,"email",t)},expression:"dialog.fields.email"}})],1),a("el-form-item",{attrs:{prop:"tel"}},[a("el-input",{attrs:{placeholder:"手机号码",maxlength:"20",clearable:""},model:{value:e.dialog.fields.tel,callback:function(t){e.$set(e.dialog.fields,"tel",t)},expression:"dialog.fields.tel"}})],1),a("el-form-item",[a("el-checkbox",{attrs:{label:"启用",name:"status"},model:{value:e.dialog.fields.status,callback:function(t){e.$set(e.dialog.fields,"status",t)},expression:"dialog.fields.status"}}),a("el-checkbox",{attrs:{label:"手机验证",name:"tel_verification"},model:{value:e.dialog.fields.tel_verification,callback:function(t){e.$set(e.dialog.fields,"tel_verification",t)},expression:"dialog.fields.tel_verification"}}),a("el-checkbox",{attrs:{label:"邮件验证",name:"email_verification"},model:{value:e.dialog.fields.email_verification,callback:function(t){e.$set(e.dialog.fields,"email_verification",t)},expression:"dialog.fields.email_verification"}}),e.dialog.fields.id!=e.id?a("el-checkbox",{attrs:{label:"管理员",name:"level"},model:{value:e.dialog.fields.admin,callback:function(t){e.$set(e.dialog.fields,"admin",t)},expression:"dialog.fields.admin"}}):e._e()],1)],1)],1),!e.dialog.edit&&e.dialog.fields.admin?a("el-form-item",{attrs:{prop:"permission"}},e._l(e.dialog.permissions,(function(t){return a("span",{key:t.key,staticClass:"permission",class:{active:t.selected},on:{click:function(a){return e.selectedPermission(t)}}},[e._v(e._s(t.name))])})),0):e._e(),e.dialog.edit&&e.dialog.fields.id!=e.id&&e.dialog.fields.admin?a("el-form-item",{attrs:{prop:"permission"}},e._l(e.dialog.permissions,(function(t){return a("span",{key:t.key,staticClass:"permission",class:{active:t.selected},on:{click:function(a){return e.selectedPermission(t)}}},[e._v(e._s(t.name))])})),0):e._e()],1),a("el-row",[a("el-col",{attrs:{align:"right"}},[a("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveData()}}},[e._v("确 定")])],1)],1)],1)],1)},le=[],ce=(a("1276"),{name:"user",data:function(){var e=this;return{id:null,loading:!1,first:!0,filter:{keyword:"",status:"",time:"",timeOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}},upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=user&original=200x200",data:{token:localStorage.token},before:function(t){var a="image/jpeg"===t.type,i=t.size/1024/1024<5;return a||e.$message.error("上传头像图片只能是 JPG 格式!"),i||e.$message.error("上传头像图片大小不能超过 2MB!"),a&&i},success:function(t){200==t.code?(e.dialog.fields.photo=t.result.url,e.dialog.fields.photo_id=t.result.id):e.$message.error(t.info)}},dialog:{title:"新增",show:!1,edit:!1,permissions:c,fields:{photo:"",photo_id:"",account:"",password:"",level:"0",nickname:"",email:"",email_verification:!1,tel:"",tel_verification:!1,status:!0}},items:[],pagination:{size:10,index:1},multipleSelection:[]}},mounted:function(){this.id=window.localStorage.id,setTimeout((function(e){window.bus.$emit("nav","user")}),100),this.getData()},methods:{canSelectable:function(e){return e.id!=this.id},filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.filter.time="",this.pagination.index=1,this.getData()},onPagination:function(e){this.pagination.index=e,this.getData()},onSelection:function(e){this.multipleSelection=e},batchDeleteData:function(){var e=this;if(0==this.multipleSelection.length)return this.$message.warning("至少选择一个"),!1;var t=this.multipleSelection.map((function(e){return e.id})).join(",");this.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,i={token:localStorage.token,class:"user",method:"delete",ids:t},a.next=4,e.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:r=a.sent,200==r.code?(e.loading=!1,e.getData()):e.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),e.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[5,12]])}))))},addData:function(){this.dialog.show=!0,this.dialog.edit=!1,this.dialog.title="创建会员",this.dialog.fields={photo:"",photo_id:"",account:"",password:"",level:"0",nickname:"",email:"",email_verification:!1,tel:"",tel_verification:!1,status:!0},this.dialog.permissions.forEach((function(e){return e.selected=!0}))},editData:function(e){e.status=1==e.status,this.dialog.show=!0,this.dialog.edit=!0,this.dialog.title="编辑会员",this.dialog.fields=e,"super"!=e.permission?this.dialog.permissions.forEach((function(t){return t.selected=e.permission&&e.permission.split(",").includes(t.key)})):this.dialog.permissions.forEach((function(e){return e.selected=!0}))},deleteData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"user",method:"delete",ids:e},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:r=a.sent,200==r.code?(t.loading=!1,t.getData()):t.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[5,12]])}))));case 1:case"end":return a.stop()}}),a)})))()},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"user",method:"search",page_index:e.pagination.index,page_size:e.pagination.size},""!=e.filter.keyword&&(a.keyword=e.filter.keyword),""!=e.filter.time&&(a.begin=+new Date(e.filter.time[0])/1e3>>0,a.end=+new Date(e.filter.time[1])/1e3>>0),""!=e.filter.status&&(a.status=e.filter.status),t.next=7,e.$http.get("/api.php",{params:a});case 7:return i=t.sent,t.prev=8,t.next=11,i.data;case 11:n=t.sent,200==n.code?(n.result.data.forEach((function(e){e.tel_verification=1==e.tel_verification,e.email_verification=1==e.email_verification,e.admin=255==e.level,e.join_time=new Date(1e3*e.join_time).format("yyyy/mm/dd h:i"),e.login_time=new Date(1e3*e.login_time).format("yyyy/mm/dd h:i")})),e.items=n.result,e.loading=!1,e.first=!1):e.$message.error(n.code),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](8),e.$message.error("网络异常");case 18:case"end":return t.stop()}}),t,null,[[8,15]])})))()},saveData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.dialog.fields.account){t.next=3;break}return e.$message.error("账号不能为空"),t.abrupt("return");case 3:if(""!=e.dialog.fields.nickname){t.next=6;break}return e.$message.error("昵称不能为空"),t.abrupt("return");case 6:if(e.dialog.edit||""!=e.dialog.fields.password){t.next=9;break}return e.$message.error("密码不能为空"),t.abrupt("return");case 9:if(e.dialog.edit||!(e.dialog.fields.password.length<5)){t.next=12;break}return e.$message.error("密码不能小于5位"),t.abrupt("return");case 12:return a=JSON.parse(JSON.stringify(e.dialog.fields)),a.email_verification=a.email_verification?1:0,a.tel_verification=a.tel_verification?1:0,a.level=a.admin?255:0,a.status=a.status?1:0,0==e.dialog.permissions.filter((function(e){return 0==e.selected})).length?a.permission="super":a.permission=e.dialog.permissions.filter((function(e){return e.selected})).map((function(e){return e.key})).join(","),i=Object(G["a"])({token:localStorage.token,class:"user",method:"save",id:e.$route.query.id},a),t.next=21,e.$http.post("/api.php",d.a.stringify(i));case 21:return n=t.sent,t.prev=22,t.next=25,n.data;case 25:r=t.sent,200==r.code?(e.dialog.show=!1,e.pagination.index=1,e.getData()):e.$message.error(r.code),t.next=32;break;case 29:t.prev=29,t.t0=t["catch"](22),e.$message.error("网络异常");case 32:case"end":return t.stop()}}),t,null,[[22,29]])})))()},selectedPermission:function(e){e.selected?e.selected=!1:e.selected=!0,this.$forceUpdate()}}}),ue=ce,de=(a("3f01"),Object(g["a"])(ue,oe,le,!1,null,"082dc268",null)),pe=de.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[a("h1",[e._v("标签管理")]),a("p",[e._v("可作为发布新闻、通知、笔记等信息。")])]),a("el-col",{attrs:{span:8,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addData()}}},[e._v("新增")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:e.filter}},[a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"关键字"},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword",t)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.filterSubmit()}}},[e._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(t){return e.filterReset()}}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.result.data,"tooltip-effect":"dark"},on:{"selection-change":e.onSelection}},[a("el-table-column",{attrs:{align:"center",label:"编号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.id))]}}])}),a("el-table-column",{attrs:{label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{align:"center",label:"标签",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.tag))]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"success",size:"small"}},[e._v("启用")]):e._e(),0==t.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"danger",size:"small"}},[e._v("禁用")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.moveUp(t.$index)}}},[e._v("上移")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.moveDown(t.$index)}}},[e._v("下移")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")])]}}])})],1)],1),e.result.data&&e.result.data.length>0&&e.result.total>e.pagination.size?a("div",{staticClass:"box-footer"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.result.total,"page-size":e.pagination.size},on:{"current-change":e.onPagination}})],1):e._e()]),e._m(0)],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,width:"30%"},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",[a("el-form-item",[a("el-input",{attrs:{placeholder:"名称"},model:{value:e.dialog.fields.name,callback:function(t){e.$set(e.dialog.fields,"name",t)},expression:"dialog.fields.name"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"标签（可选）"},model:{value:e.dialog.fields.tag,callback:function(t){e.$set(e.dialog.fields,"tag",t)},expression:"dialog.fields.tag"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"启用",name:"status"},model:{value:e.dialog.fields.status,callback:function(t){e.$set(e.dialog.fields,"status",t)},expression:"dialog.fields.status"}}),e._v(" "),a("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveData()}}},[e._v("确 定")])],1)],1)],1)},ge=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"important warn"},[a("strong",[e._v("使用帮助")]),a("br"),e._v("标签中的标签字段是用于二次开发时候使用的，比如在首页有些标签需要显示图片列表可以用标签字段值进行区别显示。 ")])}],me={data:function(){return{loading:!1,first:!0,filter:{keyword:"",status:""},dialog:{title:"修改",show:!1,fields:{name:"",tag:"",status:!0}},result:{},pagination:{size:1e5,index:1},multipleSelection:[]}},mounted:function(){setTimeout((function(e){window.bus.$emit("nav","tag")}),100),this.getData()},methods:{filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.filter.time="",this.pagination.index=1,this.getData()},onPagination:function(e){this.pagination.current=e,this.getData()},onSelection:function(e){this.multipleSelection=e},onSelectionToggle:function(){this.$refs.table.toggleAllSelection()},addData:function(){this.dialog={title:"新增",show:!0,fields:{name:"",tag:"",status:!0}}},editData:function(e){var t=JSON.parse(JSON.stringify(e));t.status=1==t.status,this.dialog={title:"编辑",show:!0,fields:t}},deleteData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"tag",method:"delete",id:e.id},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:r=a.sent,200==r.code?(t.loading=!1,t.getData()):t.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[5,12]])}))));case 1:case"end":return a.stop()}}),a)})))()},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"tag",method:"search",page_index:e.pagination.index,page_size:e.pagination.size},""!=e.filter.keyword&&(a.keyword=e.filter.keyword),""!=e.filter.status&&(a.status=e.filter.status),t.next=6,e.$http.get("/api.php",{params:a});case 6:return i=t.sent,t.prev=7,t.next=10,i.data;case 10:n=t.sent,200==n.code?(e.result=n.result,e.loading=!1,e.first=!1):e.$message.error(n.code),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),e.$message.error("网络异常");case 17:case"end":return t.stop()}}),t,null,[[7,14]])})))()},saveData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.dialog.name){t.next=3;break}return e.$message.error("标签不能为空"),t.abrupt("return");case 3:return e.loading=!0,a=JSON.parse(JSON.stringify(e.dialog.fields)),a.status=a.status?1:0,i=Object(G["a"])({token:localStorage.token,class:"tag",method:"save"},a),t.next=9,e.$http.get("/api.php",{params:i});case 9:return n=t.sent,t.prev=10,t.next=13,n.data;case 13:r=t.sent,200==r.code?(e.loading=!1,e.dialog.show=!1,e.getData()):e.$message.error(r.code),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](10),e.$message.error("网络异常");case 20:case"end":return t.stop()}}),t,null,[[10,17]])})))()},swap:function(e,t,a){return e[a]=e.splice(t,1,e[a])[0],e},moveUp:function(e){0!=e&&(this.swap(this.result.data,e,e-1),this.updateSort())},moveDown:function(e){e!=this.result.data.length-1&&(this.swap(this.result.data,e,e+1),this.updateSort())},updateSort:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={token:localStorage.token,class:"tag",method:"update_sort",ids:e.result.data.map((function(e){return e.id})).join(",")},t.next=3,e.$http.get("/api.php",{params:a});case 3:return i=t.sent,t.prev=4,t.next=7,i.data;case 7:n=t.sent,200==n.code||e.$message.error(n.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.$message.error("网络异常");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()}}},he=me,ve=(a("330c"),Object(g["a"])(he,fe,ge,!1,null,"3f505c37",null)),be=ve.exports,we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[a("h1",[e._v("链接管理")]),a("p",[e._v("可作为友情链接，合作伙伴或者图片轮播")])]),a("el-col",{attrs:{span:8,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addData()}}},[e._v("新增")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-header"},[a("el-form",{staticClass:"filter-form",staticStyle:{height:"40px"},attrs:{inline:!0,model:e.filter}},[a("el-form-item",[a("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"关键字(标题/网址/标签)"},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterSubmit()}},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword",t)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}},[a("el-option",{attrs:{label:"启用",value:"1"}}),a("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.filterSubmit()}}},[e._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{type:"normal"},on:{click:function(t){return e.filterReset()}}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.result.data}},[a("el-table-column",{attrs:{label:"图片",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!=t.row.image?a("div",{staticClass:"empty",style:{"background-image":"url("+t.row.image+")"},on:{click:function(a){return e.open(t.row.image)}}}):e._e(),""==t.row.image?a("div",{staticClass:"empty"},[e._v("?")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"标题",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b",[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"网址"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"success",target:"_blank",href:t.row.url}},[e._v(e._s(t.row.url))])]}}])}),a("el-table-column",{attrs:{label:"标签",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("b",[e._v(e._s(t.row.tag))])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"success",size:"small"}},[e._v("启用")]):e._e(),0==t.row.status?a("el-tag",{attrs:{"disable-transitions":!1,type:"danger",size:"small"}},[e._v("禁用")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.moveUp(t.$index)}}},[e._v("上移")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.moveDown(t.$index)}}},[e._v("下移")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")])]}}])})],1)],1),e.result.data&&e.result.data.length>0&&e.result.total>e.pagination.size?a("div",{staticClass:"box-footer"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.result.total,"page-size":e.pagination.size},on:{"current-change":e.onPagination}})],1):e._e()]),e._m(0)],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,width:"40%"},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"image",style:{"background-image":"url("+this.dialog.fields.image+")"}},[a("el-upload",{staticClass:"el-upload",attrs:{action:e.upload.action,data:e.upload.data,"show-file-list":!1,"on-success":e.upload.success,"before-upload":e.upload.before}},[a("div",{staticClass:"placeholder"},[""==e.dialog.fields.image?[e._v("图片(可选)")]:e._e()],2)]),""!=e.dialog.fields.image?a("div",{staticClass:"delete",on:{click:function(t){t.stopPropagation(),e.dialog.fields.image=""}}}):e._e()],1)]),a("el-col",{attrs:{span:18}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"标题"},model:{value:e.dialog.fields.title,callback:function(t){e.$set(e.dialog.fields,"title",t)},expression:"dialog.fields.title"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"网址"},model:{value:e.dialog.fields.url,callback:function(t){e.$set(e.dialog.fields,"url",t)},expression:"dialog.fields.url"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"标签（可选）",maxlength:"10"},model:{value:e.dialog.fields.tag,callback:function(t){e.$set(e.dialog.fields,"tag",t)},expression:"dialog.fields.tag"}})],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:e.dialog.fields.status,callback:function(t){e.$set(e.dialog.fields,"status",t)},expression:"dialog.fields.status"}}),e._v(" "),a("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveData()}}},[e._v("确 定")])],1)],1)],1)},ke=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"important warn"},[a("strong",[e._v("使用帮助")]),a("br"),e._v("链接标签是用于二次开发模板的时候用的，可以做轮换图片模块等。 ")])}],_e={data:function(){var e=this;return{loading:!1,first:!0,upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=link",data:{token:localStorage.token},before:function(t){var a="image/jpeg"===t.type||"image/png"===t.type||"image/svg+xml"===t.type||"image/gif"===t.type,i=t.size/1024/1024<1;return a||e.$message.error("上传图片格式错误!"),i||e.$message.error("上传图片大小不能超过 1MB!"),a&&i},success:function(t){200==t.code?(e.dialog.fields.image_id=t.result.id,e.dialog.fields.image=t.result.url):e.$message.error(t.info)}},filter:{keyword:"",status:""},dialog:{title:"新增",show:!1,fields:{image:"",image_id:"",title:"",url:"",tag:"",status:!0}},result:{},pagination:{size:1e5,index:1}}},computed:{},mounted:function(){setTimeout((function(){window.bus.$emit("nav","link")}),100),this.getData()},methods:{open:function(e){window.open(e)},filterSubmit:function(){this.getData()},filterReset:function(){this.filter.keyword="",this.filter.status="",this.pagination.index=1,this.getData()},onPagination:function(e){this.pagination.index=e,this.getData()},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"link",method:"search",page_size:e.pagination.size,page_index:e.pagination.index},""!=e.filter.keyword&&(a.keyword=e.filter.keyword),""!=e.filter.status&&(a.status=e.filter.status),t.next=6,e.$http.get("/api.php",{params:a});case 6:return i=t.sent,t.prev=7,t.next=10,i.data;case 10:n=t.sent,200==n.code?(n.result.data.forEach((function(e){e.status=1==e.status})),e.result=n.result,e.loading=!1,e.first=!1):e.$message.error(n.code),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](7),e.$message.error("网络异常");case 17:case"end":return t.stop()}}),t,null,[[7,14]])})))()},addData:function(){this.dialog={title:"添加",show:!0,fields:{image:"",image_id:"",title:"",url:"",tag:"",status:!0}}},editData:function(e){var t=JSON.parse(JSON.stringify(e));t.status=1==t.status,this.dialog={title:"编辑",show:!0,fields:Object(G["a"])({},t)}},deleteData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"link",method:"delete",id:e.id},a.next=4,t.$http.get("/api.php",{params:i});case 4:return n=a.sent,a.prev=5,a.next=8,n.data;case 8:r=a.sent,200==r.code?(t.loading=!1,t.getData()):t.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](5),t.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[5,12]])}))));case 1:case"end":return a.stop()}}),a)})))()},saveData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.dialog.fields.title){t.next=3;break}return e.$message.error("标题不能为空"),t.abrupt("return");case 3:if(""!=e.dialog.fields.url){t.next=6;break}return e.$message.error("网址不能为空"),t.abrupt("return");case 6:return e.loading=!0,a=JSON.parse(JSON.stringify(e.dialog.fields)),a.status=a.status?1:0,i=Object(G["a"])({token:localStorage.token,class:"link",method:"save"},a),t.next=12,e.$http.get("/api.php",{params:i});case 12:return n=t.sent,t.prev=13,t.next=16,n.data;case 16:r=t.sent,200==r.code?(e.loading=!1,e.dialog.show=!1,e.getData()):e.$message.error(r.code),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](13),e.$message.error("网络异常");case 23:case"end":return t.stop()}}),t,null,[[13,20]])})))()},swap:function(e,t,a){return e[a]=e.splice(t,1,e[a])[0],e},moveUp:function(e){0!=e&&(this.swap(this.result.data,e,e-1),this.updateSort())},moveDown:function(e){e!=this.result.data.length-1&&(this.swap(this.result.data,e,e+1),this.updateSort())},updateSort:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={token:localStorage.token,class:"link",method:"update_sort",ids:e.result.data.map((function(e){return e.id})).join(",")},t.next=3,e.$http.get("/api.php",{params:a});case 3:return i=t.sent,t.prev=4,t.next=7,i.data;case 7:n=t.sent,200==n.code||e.$message.error(n.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.$message.error("网络异常");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()}}},xe=_e,ye=(a("71c2"),Object(g["a"])(xe,we,ke,!1,null,"12f7ffde",null)),$e=ye.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[a("h1",[e._v("数据备份/还原")]),a("p",[e._v("快速备份数据库，快速恢复数据库")])]),a("el-col",{attrs:{span:8,align:"right"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.backup()}}},[e._v("立即备份")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.items}},[a("el-table-column",{attrs:{label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.time))]}}])}),a("el-table-column",{attrs:{label:"文件名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success"},on:{click:function(a){return e.restore(t.row.name)}}},[e._v("恢复还原")])]}}])})],1)],1)]),e._m(0)],1)])},Ce=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"important warn"},[a("strong",[e._v("使用说明")]),a("br"),e._v("还原数据库会覆盖现有的数据库，请谨慎操作。 ")])}],De={name:"backup",data:function(){return{loading:!1,first:!0,items:[]}},computed:{},mounted:function(){setTimeout((function(e){window.bus.$emit("nav","backup")}),100),this.getData()},methods:{getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"backup",method:"search"},t.next=4,e.$http.get("/api.php",{params:a});case 4:return i=t.sent,t.prev=5,t.next=8,i.data;case 8:n=t.sent,200==n.code?(e.items=n.result,e.loading=!1,e.first=!1):e.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](5),e.$message.error("网络异常");case 15:case"end":return t.stop()}}),t,null,[[5,12]])})))()},backup:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={token:localStorage.token,class:"backup",method:"backup"},t.next=3,e.$http.get("/api.php",{params:a});case 3:return i=t.sent,t.prev=4,t.next=7,i.data;case 7:n=t.sent,200==n.code?(e.getData(),e.$message.success("备份成功")):e.$message.error(n.code),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](4),e.$message.error("网络异常");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})))()},restore:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确定要还原数据库吗？还原后现有的数据库将会被覆盖！").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={token:localStorage.token,class:"backup",method:"restore",file:e},a.next=3,t.$http.get("/api.php",{params:i});case 3:return n=a.sent,a.prev=4,a.next=7,n.data;case 7:r=a.sent,200==r.code?(t.getData(),t.$message.success("还原成功")):t.$message.error("还原失败"),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](4),t.$message.error("网络异常");case 14:case"end":return a.stop()}}),a,null,[[4,11]])}))));case 1:case"end":return a.stop()}}),a)})))()}}},Oe=De,Re=Object(g["a"])(Oe,Se,Ce,!1,null,null,null),je=Re.exports,ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"layout"},[a("el-row",{staticClass:"caption",attrs:{type:"flex",align:"middle"}},[a("el-col",{attrs:{span:16}},[a("h1",[e._v("全局设置")]),a("p",[e._v("全局变量设置，可设置纯文本、HTML、上传文件、开关")])]),a("el-col",{attrs:{span:8,align:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addData()}}},[e._v("新增")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"box-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.items}},[a("el-table-column",{attrs:{label:"状态",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?a("el-tag",{attrs:{type:"success",size:"small"}},[e._v("正常")]):e._e(),0==t.row.status?a("el-tag",{attrs:{type:"danger",size:"small"}},[e._v("禁用")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.description)+" ("+e._s(t.row.key)+")")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")])]}}])})],1)],1)])],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,width:"650px"},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"变量"}},[a("el-input",{attrs:{placeholder:"只允许大小写字母、数字、-_.等字符"},model:{value:e.dialog.fields.key,callback:function(t){e.$set(e.dialog.fields,"key",t)},expression:"dialog.fields.key"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"这个变量是用来做什么的？"},model:{value:e.dialog.fields.description,callback:function(t){e.$set(e.dialog.fields,"description",t)},expression:"dialog.fields.description"}})],1),a("el-form-item",{attrs:{label:"内容"}},[a("el-radio",{attrs:{label:0,disabled:e.edit},nativeOn:{click:function(t){e.dialog.fields.value=""}},model:{value:e.dialog.fields.type,callback:function(t){e.$set(e.dialog.fields,"type",t)},expression:"dialog.fields.type"}},[e._v("纯文本")]),a("el-radio",{attrs:{label:1,disabled:e.edit},nativeOn:{click:function(t){e.dialog.fields.value=""}},model:{value:e.dialog.fields.type,callback:function(t){e.$set(e.dialog.fields,"type",t)},expression:"dialog.fields.type"}},[e._v("富文本")]),a("el-radio",{attrs:{label:2,disabled:e.edit},nativeOn:{click:function(t){e.dialog.fields.value=""}},model:{value:e.dialog.fields.type,callback:function(t){e.$set(e.dialog.fields,"type",t)},expression:"dialog.fields.type"}},[e._v("上传文件")]),a("el-radio",{attrs:{label:3,disabled:e.edit},nativeOn:{click:function(t){e.dialog.fields.value="off"}},model:{value:e.dialog.fields.type,callback:function(t){e.$set(e.dialog.fields,"type",t)},expression:"dialog.fields.type"}},[e._v("开关")])],1),a("el-form-item",{attrs:{label:" "}},[0==e.dialog.fields.type?[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.dialog.fields.value,callback:function(t){e.$set(e.dialog.fields,"value",t)},expression:"dialog.fields.value"}})]:e._e(),1==e.dialog.fields.type?[a("editor",{ref:"editor",attrs:{height:150},model:{value:e.dialog.fields.value,callback:function(t){e.$set(e.dialog.fields,"value",t)},expression:"dialog.fields.value"}}),a("br")]:e._e(),2==e.dialog.fields.type?[e.uploadIsImage?a("img",{attrs:{src:e.dialog.fields.value,width:"100%"}}):e.uploadIsVideo?a("video",{attrs:{controls:"controls",src:e.dialog.fields.value,width:"100%",height:"auto"}}):a("a",{attrs:{href:e.dialog.fields.value,target:"_blank"},domProps:{textContent:e._s(e.dialog.fields.value)}})]:e._e(),3==e.dialog.fields.type?[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off","active-text":"on","inactive-text":"off"},model:{value:e.dialog.switch,callback:function(t){e.$set(e.dialog,"switch",t)},expression:"dialog.switch"}})]:e._e(),1==e.dialog.fields.type||2==e.dialog.fields.type?a("el-upload",{attrs:{action:e.upload.action,data:e.upload.data,"show-file-list":!1,"on-success":e.upload.success,"before-upload":e.upload.before,"on-progress":e.upload.progress}},[a("el-button",{attrs:{type:"primary"}},[e._v(" 上传文件 "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1):e._e()],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-checkbox",{attrs:{label:"发布",name:"status"},model:{value:e.dialog.fields.status,callback:function(t){e.$set(e.dialog.fields,"status",t)},expression:"dialog.fields.status"}}),e._v(" "),a("el-button",{on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("确 定")])],1)],1)],1)},Ee=[],Te=(a("a4d3"),a("e01a"),a("baa5"),{name:"config",components:{editor:ae},watch:{"dialog.switch":function(e){3==dialog.fields.type?this.dialog.fields.value=e?"on":"off":this.dialog.fields.value=""}},data:function(){var e=this;return{loading:!1,first:!0,edit:!1,files:[],upload:{action:this.$http.defaults.baseURL+"/api.php?class=upload&method=go&bind_type=config",data:{token:localStorage.token},before:function(t){var a=t.size/1024/1024<50;return a||e.$message.error("上传大小不能超过 50MB!"),a},loading:!1,progress:function(t){var a=Math.floor(t.loaded/t.total*100);a<100&&(e.upload.loading=!0)},success:function(t){200==t.code?e.addFile(t.result):e.$message.error(t.info)}},file:[],dialog:{title:"添加",show:!1,switch:!1,fields:{key:"",value:"",description:"",status:!0,type:0}},items:[]}},computed:{uploadIsImage:function(){if(0==this.dialog.fields.type||""==this.dialog.fields.value)return!1;var e=this.dialog.fields.value.substring(this.dialog.fields.value.lastIndexOf(".")+1);return"jpg"==e||"gif"==e||"png"==e},uploadIsVideo:function(){if(0==this.dialog.fields.type||""==this.dialog.fields.value)return!1;var e=this.dialog.fields.value.substring(this.dialog.fields.value.lastIndexOf(".")+1);return"mp4"==e}},mounted:function(){setTimeout((function(e){window.bus.$emit("nav","config")}),100),this.getData()},methods:{setContent:function(e){var t=Z.a.activeEditor.getContent();Z.a.activeEditor.setContent(t+e)},addFile:function(e){0==this.dialog.fields.type?e.image?this.setContent('<img src="'.concat(e.url,'" style="max-width:100%">')):"video/mp4"==e.type?this.setContent('<video controls="controls" width="720" height="480"><source src="'.concat(e.url,'" type="video/mp4" /></video>')):this.setContent('<a href="'.concat(e.url,'">').concat(e.name,"</a>")):this.dialog.fields.value=e.url},getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={token:localStorage.token,class:"config",method:"gets"},t.prev=2,t.next=5,e.$http.get("/api.php",{params:a});case 5:return i=t.sent,t.next=8,i.data;case 8:n=t.sent,200==n.code?(n.result.forEach((function(e){e.status=1==e.status})),e.items=n.result,e.loading=!1,e.first=!1):e.$message.error(n.code),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),e.$message.error("网络异常");case 15:case"end":return t.stop()}}),t,null,[[2,12]])})))()},addData:function(){this.edit=!1,this.dialog={title:"创建变量",show:!0,fields:{key:"",value:"",description:"",status:!0,type:0}}},editData:function(e){this.edit=!0,this.dialog={title:"修改设置",show:!0,fields:Object(G["a"])({},e)}},deleteData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("确认要删除吗").then(Object(l["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,i={token:localStorage.token,class:"config",method:"delete",key:e.key},a.prev=2,a.next=5,t.$http.get("/api.php",{params:i});case 5:return n=a.sent,a.next=8,n.data;case 8:r=a.sent,200==r.code?(t.loading=!1,t.getData()):t.$message.error(r.code),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](2),t.$message.error("网络异常");case 15:case"end":return a.stop()}}),a,null,[[2,12]])}))));case 1:case"end":return a.stop()}}),a)})))()},deleteFile:function(e){this.files.splice(e,1)},save:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=e.dialog.fields.key){t.next=3;break}return e.$message.warning("数据未填写完整"),t.abrupt("return");case 3:if(/^[a-zA-Z0-9-_\.]*$/.test(e.dialog.fields.key)){t.next=6;break}return e.$message.warning("变量只允许大小写字母数字和“-”，“_”，“.”字符串"),t.abrupt("return");case 6:return e.loading=!0,a={token:localStorage.token,class:"config",method:"save",key:e.dialog.fields.key,value:e.dialog.fields.value,description:e.dialog.fields.description,status:e.dialog.fields.status?1:0,type:e.dialog.fields.type},t.prev=8,t.next=11,e.$http.post("/api.php",d.a.stringify(a));case 11:return i=t.sent,t.next=14,i.data;case 14:n=t.sent,200==n.code?(e.loading=!1,e.dialog.show=!1,e.getData()):e.$message.error(n.code),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](8),e.$message.error("网络异常");case 21:case"end":return t.stop()}}),t,null,[[8,18]])})))()}}}),Pe=Te,Ne=(a("c9cb"),Object(g["a"])(Pe,ze,Ee,!1,null,"28b56eb2",null)),Ie=Ne.exports;i["default"].use(_["a"]);var Me=new _["a"]({routes:[{path:"*",component:F},{path:"/",component:T},{path:"/dashboard",component:D},{path:"/post",component:B},{path:"/post-form",component:se},{path:"/user",component:pe},{path:"/tag",component:be},{path:"/link",component:$e},{path:"/backup",component:je},{path:"/config",component:Ie}]}),Fe=a("5c96"),Je=a.n(Fe),Ue=(a("0fae"),a("fe3c")),qe=a.n(Ue),Le=a("bc3a"),Ve=a.n(Le);i["default"].use(Je.a),qe.a.prototype.focus=function(e){var t;/ios/g.test(window.navigator.userAgent.toLowerCase())&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.focus(),e.setSelectionRange(t,t)):e.focus()},window.localStorage.server&&(Ve.a.defaults.baseURL=window.localStorage.server),Ve.a.defaults.timeout=6e4,Ve.a.defaults.headers["Content-Type"]="application/x-www-form-urlencoded",Ve.a.interceptors.response.use((function(e){return 403==e.data.code?(window.localStorage.removeItem("token"),void window.bus.$emit("kick")):e}),(function(e){return window.bus.$emit("kick"),Promise.reject(e)})),i["default"].prototype.$http=Ve.a,i["default"].config.productionTip=!1,window.bus=new i["default"],Me.afterEach((function(e,t){localStorage.token?Ve.a.post("/api.php",d.a.stringify({class:"dashboard",method:"noop",token:localStorage.token})).then((function(e){e&&200!=e.data.code&&Me.push({path:"/"})})):Me.push({path:"/"})})),new i["default"]({router:Me,render:function(e){return e(k)}}).$mount("#app"),Date.prototype.format=function(e){var t=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i={"y+":this.getFullYear(),"m+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"i+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),n:this.getMilliseconds(),M:t[this.getMonth()],W:a[this.getDay()]};for(var n in i)new RegExp("("+n+")").test(e)&&(e="y+"==n?e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)):e.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return e}},"5d46":function(e,t,a){"use strict";a("67b6")},"67b6":function(e,t,a){},"71c2":function(e,t,a){"use strict";a("0794")},"87e8":function(e,t,a){},"8a72":function(e,t,a){"use strict";a("d518")},"8ff6":function(e,t,a){},"9ef5":function(e,t,a){"use strict";a("cce6")},a4c4:function(e,t,a){},aaa6:function(e,t,a){},adcf:function(e,t,a){},c9cb:function(e,t,a){"use strict";a("a4c4")},cad7:function(e,t,a){},cce6:function(e,t,a){},d518:function(e,t,a){},d9ab:function(e,t,a){"use strict";a("87e8")},e3ab:function(e,t,a){"use strict";a("8ff6")},f019:function(e,t,a){"use strict";a("52f9")}});